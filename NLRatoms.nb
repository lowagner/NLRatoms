(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    207938,       4934]
NotebookOptionsPosition[    206548,       4888]
NotebookOutlinePosition[    206882,       4903]
CellTagsIndexPosition[    206839,       4900]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["(* Definitions *)", "Title",
 CellChangeTimes->{{3.61148124822961*^9, 3.61148125670442*^9}, {
  3.611566904487549*^9, 3.611566912538991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "block", " ", "defines", " ", "all", " ", "the", " ", 
     "necessary", " ", 
     RowBox[{"routines", ".", "  ", "Run"}], " ", "this"}], ",", " ", 
    RowBox[{
    "then", " ", "check", " ", "out", " ", "some", " ", "examples", " ", 
     "after", " ", 
     RowBox[{"it", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "ri", ",", "c2", ",", "c4", ",", "getFourthOrderKE", ",", 
     "getSecondOrderKE", ",", "getWH", ",", "getvH", ",", "getvHpoint", ",", 
     "getRnl", ",", "getRnlpoint", ",", "getWxcNLR", ",", 
     "getvxcNLRdirectpoint", ",", "SphereIntegrate"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Some", " ", "defaults"}], " ", "*)"}], "Subtitle"], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"guess", " ", "for", " ", 
     SubscriptBox["R", "NL"], " ", "at", " ", "the", " ", "origin"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"guessR0", "=", "1"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"BuildSpline", " ", "parameters"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "tolerance", " ", "to", " ", "get", " ", "functions", " ", "within", " ",
       "to", " ", 
      RowBox[{"(", 
       RowBox[{"at", " ", "any", " ", "given", " ", "point"}], ")"}], " ", 
      "by", " ", "using", " ", "a", " ", "refined", " ", 
      RowBox[{"spline", ".", "  ", "you"}], " ", "will", " ", "probably", " ",
       "get", " ", "better", " ", "than", " ", "this", " ", 
      RowBox[{"(", 
       RowBox[{"see", " ", "the", " ", "BuildSpline", " ", "function"}], 
       ")"}]}], ",", " ", 
     RowBox[{"but", " ", 
      RowBox[{"it", "'"}], "s", " ", "a", " ", 
      RowBox[{"start", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FUNCTIONtolerance", "=", "10*^-6"}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{
     "NOT", " ", "RECOMMENDED", " ", "TO", " ", "BE", " ", "OR", " ", "GO", 
      " ", "BELOW", " ", "10*^-7"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "if", " ", "x", " ", "coordinates", " ", "in", " ", "building", " ", 
       "a", " ", "spline", " ", "are", " ", "smaller", " ", "than", " ", 
       "this"}], ",", " ", 
      RowBox[{"skip", " ", "ahead"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"TOOsmallDELTArSPLINE", "=", "10*^-5"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"whether", " ", "to", " ", "debug", " ", 
     RowBox[{"(", 
      RowBox[{"print", " ", "lots", " ", "of", " ", "stuff"}], ")"}], " ", 
     "or", " ", "not"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DEBUG", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUPERdebug", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"occupation", " ", "of", " ", 
     RowBox[{"s", "/", "p"}], " ", "orbitals"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soccupy", "=", 
     RowBox[{"{", "2", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poccupy", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "Debugging", " ", "*)"}], "Subtitle"], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"printing", " ", "indent", " ", "level"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INDENT", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "prints", " ", "something", " ", "temporary", " ", "if", 
      " ", "not", " ", "in", " ", "debug", " ", "mode"}], ",", " ", 
     RowBox[{"and", " ", "permanent", " ", "if", " ", "in", " ", "debug"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintPermanentDEBUG", "[", "string_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"DEBUG", ",", 
      RowBox[{"Print", "[", 
       RowBox[{"INDENT", "<>", "string"}], "]"}], ",", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"INDENT", "<>", "string"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "prints", " ", "only", " ", "if", " ", "in", " ", "debug", 
     " ", "mode"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintOnlyDEBUG", "[", "string_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"DEBUG", ",", 
      RowBox[{"Print", "[", 
       RowBox[{"INDENT", "<>", "string"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Definition", " ", "of", " ", "the", " ", "grid"}], " ", "*)"}], 
    "Subtitle"], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "points", " ", "follow", " ", "a", " ", "slowly", " ", "increasing", " ", 
     "radial", " ", "grid"}], " ", "*)"}], 
   StyleBox["\[IndentingNewLine]", "Subtitle"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ri", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"i", " ", "GRIDdelta"}], " ", "+", " ", 
     RowBox[{"MULTIPLIER", " ", "GRIDdelta", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], 
      RowBox[{"i", "/", "2"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"GRIDmin", ":=", 
    RowBox[{"ri", "[", "1", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"GRIDmax", ":=", 
    RowBox[{"ri", "[", "Ngrid", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]rip", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ri", "[", 
       RowBox[{"i", "+", "1"}], "]"}], "-", 
      RowBox[{"ri", "[", "i", "]"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]rim", "[", "i_", "]"}], ":=", 
    RowBox[{"\[CapitalDelta]rip", "[", 
     RowBox[{"i", "-", "1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"sparse", " ", "grid"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sparseri", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"i", " ", "SPARSEGRIDdelta"}], " ", "+", " ", 
     RowBox[{"SPARSEmultiplier", " ", "SPARSEGRIDdelta", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], 
      RowBox[{"i", "/", "2"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", "table", " ", "form"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rTABLE", ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ri", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Ngrid"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]TABLE", ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalDelta]rip", "[", "i", "]"}], "+", 
         RowBox[{"\[CapitalDelta]rim", "[", "i", "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Ngrid"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "zero", " ", "is", " ", "in", " ", "the", " ", "sparse", " ", "grid"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"SPARSErTABLE", ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sparseri", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "SPARSENgrid"}], "}"}]}], "]"}]}], 
     "]"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Kinetic", " ", "energy", " ", "pieces"}], " ", "*)"}], 
    "Subtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Second", "-", 
      RowBox[{"order", " ", "finite"}], "-", "differences"}], " ", "*)"}], 
    "Subsubtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c2", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], ")"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "4"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"MULTIPLIER", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
           "i"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "i"}], "+", 
          RowBox[{"2", " ", "MULTIPLIER", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "i", "-", 
             SuperscriptBox["i", "2"]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "i"}], ")"}]}], "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "i", "+", 
               SuperscriptBox["i", "2"]}], ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getSecondOrderKE", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KE", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Ngrid"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Ngrid"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "How", " ", "to", " ", "get", " ", "laplacian", " ", "at", " ", 
         SubscriptBox["r", "1"]}], ",", " ", 
        RowBox[{"f1", "=", 
         RowBox[{
          RowBox[{"f", "[", 
           SubscriptBox["r", "1"], "]"}], "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f0", "=", 
       RowBox[{"f1", "-", 
        RowBox[{"GRIDdelta", 
         RowBox[{"(", "   ", 
          RowBox[{"(", "  ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"f2", "-", "f1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"GRIDdelta", 
              RowBox[{"(", 
               RowBox[{"1", "+", "MULTIPLIER"}], ")"}]}], ")"}]}], "  ", 
           ")"}], "    ", ")"}]}]}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"assume", " ", "f0"}], "=", 
         RowBox[{"f", "[", 
          RowBox[{
           SubscriptBox["r", "0"], " ", "=", " ", "0"}], "]"}]}], ",", " ", 
        RowBox[{
        "can", " ", "be", " ", "extrapolated", " ", "linearly", " ", "to"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"using", " ", 
          RowBox[{"f", "[", 
           SubscriptBox["r", "1"], "]"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"f1", " ", "and", " ", "f2"}], " ", "=", " ", 
          RowBox[{"f", "[", 
           SubscriptBox["r", "2"], "]"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "use", " ", "second", " ", "order", " ", "formula", " ", "and", " ", 
        "insert", " ", "f0", " ", "as", " ", "a", " ", "function", " ", "of", 
        " ", "f1", " ", "and", " ", "f2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"KE2i", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"c2", "[", "1", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"f0", ",", "f1", ",", "f2"}], "}"}]}], "//", "Simplify"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KE", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"KE2i", ",", "f1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KE", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"KE2i", ",", "f2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"IGNORE", " ", 
        RowBox[{"KE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "2"}], ",", 
        RowBox[{"i", "\[LessEqual]", "Ngrid"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"KE2ic", "=", 
          RowBox[{"c2", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "KE2ic", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "-", "2", "+", "j"}], "\[LessEqual]", "Ngrid"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"KE", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"i", "-", "2", "+", "j"}]}], "]"}], "]"}], "=", 
               RowBox[{"KE2ic", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "KE"}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Fourth", "-", 
      RowBox[{"order", " ", "finite"}], "-", "differences"}], " ", "*)"}], 
    "Subsubtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c4", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], ")"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", 
           RowBox[{"2", " ", "i"}], "+", 
           RowBox[{"MULTIPLIER", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"i", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "19"}], "+", 
                 RowBox[{"5", " ", "i"}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["MULTIPLIER", "2"], " ", "i", " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", 
                 RowBox[{"i", " ", 
                  RowBox[{"(", 
                   RowBox[{"4", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "8"}], "+", "i"}], ")"}], " ", "i"}]}], 
                   ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MULTIPLIER", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"i", " ", 
                  RowBox[{"(", 
                   RowBox[{"5", "+", 
                    RowBox[{"i", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "23"}], "+", 
                    RowBox[{"4", " ", "i"}]}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "i"}], ")"}]}], "+", 
          RowBox[{"8", " ", "MULTIPLIER", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "i"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", "i"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MULTIPLIER", "3"], " ", "i", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"i", " ", 
              RowBox[{"(", 
               RowBox[{"13", "+", 
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "5"}], "+", "i"}], ")"}], " ", "i"}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["MULTIPLIER", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"i", " ", 
              RowBox[{"(", 
               RowBox[{"9", "+", 
                RowBox[{"4", " ", "i", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "7"}], "+", 
                   RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
          ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "20"}], " ", "i"}], "+", 
          RowBox[{"2", " ", "MULTIPLIER", " ", 
           RowBox[{"(", 
            RowBox[{"16", "+", 
             RowBox[{"5", " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"5", " ", "i"}]}], ")"}], " ", "i"}], "+", 
             RowBox[{"MULTIPLIER", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "16"}], "+", 
                RowBox[{"i", " ", 
                 RowBox[{"(", 
                  RowBox[{"41", "+", 
                   RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{"5", "-", 
                    RowBox[{"4", " ", "i"}]}], ")"}], " ", "i"}]}], ")"}]}]}],
                ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["MULTIPLIER", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "i", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "23"}], "+", 
                   RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "i"}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "MULTIPLIER", "+", 
            RowBox[{"2", " ", "MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "i"}], ")"}]}], "+", 
          RowBox[{"8", " ", "MULTIPLIER", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             RowBox[{"5", " ", "i", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "i"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["MULTIPLIER", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"i", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "23"}], "+", 
                RowBox[{"8", " ", "i", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "i"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MULTIPLIER", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"i", " ", 
              RowBox[{"(", 
               RowBox[{"9", "+", 
                RowBox[{"i", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "23"}], "+", 
                   RowBox[{"4", " ", "i", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "i"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "MULTIPLIER", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "i"}], ")"}]}], "+", 
          RowBox[{"MULTIPLIER", " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"i", " ", 
              RowBox[{"(", 
               RowBox[{"13", "+", 
                RowBox[{"5", " ", "i"}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["MULTIPLIER", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "i", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"i", " ", 
                 RowBox[{"(", 
                  RowBox[{"5", "+", "i"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{"MULTIPLIER", " ", 
              RowBox[{"(", 
               RowBox[{"6", "+", 
                RowBox[{"i", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "27"}], "+", 
                   RowBox[{"i", " ", 
                    RowBox[{"(", 
                    RowBox[{"13", "+", 
                    RowBox[{"4", " ", "i"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "i"}], ")"}]}]}], ")"}], " ", "i", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "MULTIPLIER", "+", 
            RowBox[{"MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "MULTIPLIER", "+", 
            RowBox[{"2", " ", "MULTIPLIER", " ", "i"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"MULTIPLIER", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "i"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["GRIDdelta", "2"]}], ")"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getFourthOrderKE", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KE", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Ngrid"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Ngrid"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "How", " ", "to", " ", "get", " ", "laplacian", " ", "at", " ", 
         SubscriptBox["r", "1"]}], ",", " ", 
        RowBox[{"f1", "=", 
         RowBox[{
          RowBox[{"f", "[", 
           SubscriptBox["r", "1"], "]"}], "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f0", "=", 
       RowBox[{"f1", "-", 
        RowBox[{"GRIDdelta", 
         RowBox[{"(", "   ", 
          RowBox[{"(", "  ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"f2", "-", "f1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"GRIDdelta", 
              RowBox[{"(", 
               RowBox[{"1", "+", "MULTIPLIER"}], ")"}]}], ")"}]}], "  ", 
           ")"}], "    ", ")"}]}]}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"assume", " ", "f0"}], "=", 
         RowBox[{"f", "[", 
          RowBox[{
           SubscriptBox["r", "0"], " ", "=", " ", "0"}], "]"}]}], ",", " ", 
        RowBox[{
        "can", " ", "be", " ", "extrapolated", " ", "linearly", " ", "to"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"using", " ", 
          RowBox[{"f", "[", 
           SubscriptBox["r", "1"], "]"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"f1", " ", "and", " ", "f2"}], " ", "=", " ", 
          RowBox[{"f", "[", 
           SubscriptBox["r", "2"], "]"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "use", " ", "second", " ", "order", " ", "formula", " ", "and", " ", 
        "insert", " ", "f0", " ", "as", " ", "a", " ", "function", " ", "of", 
        " ", "f1", " ", "and", " ", "f2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"KE2i", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"c2", "[", "1", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"f0", ",", "f1", ",", "f2"}], "}"}]}], "//", "Simplify"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KE", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"KE2i", ",", "f1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KE", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"KE2i", ",", "f2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"second", " ", "order", " ", "KE", " ", "at", " ", 
        SubscriptBox["r", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"KE2ic", "=", 
       RowBox[{"c2", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "KE2ic", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "Ngrid"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{
            RowBox[{"KE", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"KE2ic", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "fourth", " ", "order", " ", "KE", " ", "everywhere", " ", "else"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "3"}], ",", 
        RowBox[{"i", "\[LessEqual]", "Ngrid"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"KE4ic", "=", 
          RowBox[{"c4", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "KE4ic", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "-", "3", "+", "j"}], "\[LessEqual]", "Ngrid"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"KE", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"i", "-", "3", "+", "j"}]}], "]"}], "]"}], "=", 
               RowBox[{"KE4ic", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "KE"}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"General", " ", "purpose"}], " ", "-", " ", 
      RowBox[{"Spline", " ", "builder"}]}], " ", "*)"}], "Subtitle"], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BuildSpline", "[", "f_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "BuildSpline", " ", "starts", " ", "with", " ", "a", " ", "coarse", 
        " ", "grid", " ", "and", " ", "tests", " ", "points", " ", "off", " ",
         "the", " ", "grid"}], ",", " ", 
       RowBox[{"sees", " ", "if", " ", "the", " ", "tolerance", " ", 
        RowBox[{"(", "FUNCTIONtolerance", ")"}], " ", "is", " ", "ok"}], ",", 
       " ", 
       RowBox[{"and", " ", "if", " ", "not"}], ",", " ", 
       RowBox[{"adds", " ", "another", " ", "test", " ", 
        RowBox[{"point", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", "interpolation", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "PrintPermanentDEBUG", "[", 
         "\"\<first function pass through sparse grid\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"f", "[", "r", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "sparsertable"}], "}"}]}], "]"}], ",", "r"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"interpolation", "=", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"data", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "PrintPermanentDEBUG", "[", "\"\<now refining grid for spline\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "data", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], 
                "]"}], "<", "TOOsmallDELTArSPLINE"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"i", "+=", "2"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], "<", 
                  "10*^-12"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "first", " ", "x", " ", "coordinate", " ", "is", " ", 
                    "zero"}], ",", " ", 
                   RowBox[{
                   "do", " ", "something", " ", "to", " ", "average", " ", 
                    "with", " ", "second", " ", "coordinate"}]}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"newpoint", "=", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "x", " ", "coordinate", " ", "is", " ", "not", " ", 
                    "zero"}], ",", " ", 
                   RowBox[{
                   "harmonic", " ", "average", " ", "to", " ", "weight", " ", 
                    "towards", " ", "smaller", " ", "r"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"newpoint", "=", 
                  RowBox[{"2", "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
                    ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fnewpoint", "=", 
                RowBox[{"f", "[", "newpoint", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"no", " ", "matter", " ", "what"}], ",", " ", 
                 RowBox[{
                 "add", " ", "in", " ", "the", " ", "new", " ", "point", " ", 
                  "and", " ", "make", " ", "a", " ", "new", " ", 
                  "interpolation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"data", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"newpoint", ",", "fnewpoint"}], "}"}], "}"}], ",", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"PrintOnlyDEBUG", "[", 
                RowBox[{"\"\<   test r = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"newpoint", ",", 
                   RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}],
                  "<>", "\"\<; f(r) = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"fnewpoint", ",", 
                   RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}],
                  "<>", "\"\<; interp(r) = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"interpolation", "[", "newpoint", "]"}], ",", 
                   RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], 
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "but", " ", "only", " ", "move", " ", "up", " ", "in", " ", 
                 "i", " ", "if", " ", "the", " ", "interpolation", " ", "was",
                  " ", "a", " ", "good", " ", "approximation"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"fnewpoint", "-", 
                    RowBox[{"interpolation", "[", "newpoint", "]"}]}], "]"}], 
                  "<", "FUNCTIONtolerance"}], ",", 
                 RowBox[{"i", "+=", "2"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"interpolation", "=", 
                RowBox[{"Interpolation", "[", 
                 RowBox[{"data", ",", 
                  RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "have", " ", "Monitor", " ", "monitor", " ", "the", " ", 
            "newpoint", " ", "in", " ", "r"}], " ", "*)"}], 
          "\[IndentingNewLine]", "newpoint"}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"PrintPermanentDEBUG", "[", 
         RowBox[{"\"\<amount of data in spline: \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "[", "data", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "interpolation"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Nonlocal", " ", 
      RowBox[{"integrators", " ", "/", " ", "nonlocal"}], " ", "radius"}], 
     " ", "*)"}], "Subtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SphereIntegrate", "[", 
     RowBox[{"f_", ",", "r_", ",", "R_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"integrate", " ", "over", " ", 
        RowBox[{"r", "'"}]}], ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"r", "'"}], "]"}], " ", "in", " ", "a", " ", "sphere", " ", 
        "of", " ", "radius", " ", "R", " ", "concentric", " ", "with", " ", 
        "a", " ", "point", " ", "at", "\[IndentingNewLine]", "distance", " ", 
        "r", " ", "from", " ", "the", " ", "origin"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"R", "<", "10*^-12"}], ",", "\[IndentingNewLine]", "0", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"R", ">", "r"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", "<", "10*^-12"}], ",", "\[IndentingNewLine]", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"4", " ", "Pi", " ", 
              SuperscriptBox["rp", "2"], " ", 
              RowBox[{"f", "[", "rp", "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"rp", ",", "0", ",", "R"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"4", " ", "Pi", " ", 
               SuperscriptBox["rp", "2"], " ", 
               RowBox[{"f", "[", "rp", "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"rp", ",", "0", ",", 
                RowBox[{"R", "-", "r"}]}], "}"}]}], "]"}], "+", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"Pi", " ", 
               FractionBox["rp", "r"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["R", "2"], " ", "-", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"r", "-", "rp"}], ")"}], "2"]}], ")"}], " ", 
               RowBox[{"f", "[", "rp", "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"rp", ",", 
                RowBox[{"R", "-", "r"}], ",", 
                RowBox[{"R", "+", "r"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"Pi", " ", 
            FractionBox["rp", "r"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["R", "2"], " ", "-", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"r", "-", "rp"}], ")"}], "2"]}], ")"}], " ", 
            RowBox[{"f", "[", "rp", "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"rp", ",", 
             RowBox[{"r", "-", "R"}], ",", 
             RowBox[{"r", "+", "R"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"initial", " ", "guess", " ", "for", " ", "Rnl"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rnl", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"r", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"guessR0", "+", 
          RowBox[{"0.6", 
           RowBox[{"r", "^", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}]}], "+", 
          RowBox[{"r", "^", "3"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"r", "^", "2"}]}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getRnlpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "can", " ", "get", " ", "Rnl", " ", "at", " ", "a", " ", "point"}], 
       ",", " ", 
       RowBox[{
       "suspecting", " ", "the", " ", "point", " ", "given", " ", "by", " ", 
        "existing", " ", "Rnl"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"R", ",", "func"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"func", "[", "R_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"R", "<", "0"}], ",", "R", ",", 
           RowBox[{"SphereIntegrate", "[", 
            RowBox[{"n", ",", "r", ",", "R"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"func", "[", "R", "]"}], "\[Equal]", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"R", ",", 
              RowBox[{"Rnl", "[", "r", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"getRnl", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", "\"\<Calculating NL radius...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Rnl", "=", 
       RowBox[{"BuildSpline", "[", "getRnlpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", "Rnl"}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BackNLRSphereIntegrate", "[", 
     RowBox[{"f_", ",", "r_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"integrate", " ", "over", " ", 
        RowBox[{"r", "'"}]}], ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"r", "'"}], "]"}], " ", "if", " ", "r", " ", "is", " ", 
        "within", " ", "a", " ", "sphere", " ", "of", " ", "radius", " ", "R", 
        RowBox[{"(", 
         RowBox[{"r", "'"}], ")"}], " ", "concentric", " ", "with", " ", "a", 
        " ", "point", " ", "at", " ", "position", " ", 
        RowBox[{"r", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "R", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "<", "10*^-12"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"if", " ", "r", " ", "is", " ", "zero"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R", "=", 
               RowBox[{"Rnl", "[", "rp", "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"R", "<", "rp"}]}], "}"}], "}"}], ",", 
                RowBox[{"4", " ", "Pi", " ", 
                 SuperscriptBox["rp", "2"]}]}], "]"}]}], ")"}], 
            RowBox[{"f", "[", "rp", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"if", " ", "r", " ", "is", " ", "nonzero"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R", "=", 
               RowBox[{"Rnl", "[", "rp", "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"R", "<", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    FractionBox["1", "r"], 
                    RowBox[{"\[Pi]", " ", "rp", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["R", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"r", "-", "rp"}], ")"}], "2"]}], ")"}]}]}], ",", 
                    RowBox[{"R", "<", 
                    RowBox[{"r", "+", "rp"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"4", " ", "Pi", " ", 
                  SuperscriptBox["rp", "2"]}], ")"}]}], "]"}]}], ")"}], 
            RowBox[{"f", "[", "rp", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Hxc", " ", "potentials", " ", "and", " ", "energies"}], " ", 
     "*)"}], "Subtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"HARTREE", " ", "PIECES", " ", "OF", " ", "THINGS"}], " ", 
     "*)"}], "Subsubsection"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvHpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", "<", "10*^-12"}], ",", "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", "rp", ")"}], " ", 
         RowBox[{"n", "[", "rp", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"r", "+", "rp", "-", 
             RowBox[{"Abs", "[", 
              RowBox[{"r", "-", "rp"}], "]"}]}], ")"}]}], "r"], 
         RowBox[{"(", "rp", ")"}], " ", 
         RowBox[{"n", "[", "rp", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"getvH", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintPermanentDEBUG", "[", "\"\<CALCULATING vH...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vH", "=", 
       RowBox[{"BuildSpline", "[", "getvHpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", "vH"}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getWH", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", "\"\<CALCULATING WH, via vH...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vH", "=", "getvH"}], ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WH", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"r", "^", "2"}]}], ")"}], " ", 
          FractionBox["1", "2"], 
          RowBox[{"vH", "[", "r", "]"}], " ", 
          RowBox[{"n", "[", "r", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"NLR", " ", "XC", " ", "PIECES"}], " ", "*)"}], "Subsubsection"],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvxcNLRdirectpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "R", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "=", 
         RowBox[{"Rnl", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"integrate", " ", "over", " ", 
           RowBox[{"r", "'"}]}], ":", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"r", "'"}], "]"}], "/"}]}], "|", 
           RowBox[{"r", "-", 
            RowBox[{"r", "'"}]}], "|", " ", 
           RowBox[{
           "in", " ", "a", " ", "sphere", " ", "of", " ", "radius", " ", "R", 
            
            RowBox[{"(", "r", ")"}], " ", "concentric", " ", "with", " ", "a",
             " ", "point", " ", "at", "\[IndentingNewLine]", "distance", " ", 
            "r", " ", "from", " ", "the", " ", "origin"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ")"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"R", "<", "10*^-12"}], ",", "\[IndentingNewLine]", "0", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"R", ">", "r"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"r", "<", "10*^-12"}], ",", "\[IndentingNewLine]", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{"4", "Pi", " ", "rp", " ", 
                  RowBox[{"n", "[", "rp", "]"}]}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"rp", ",", "0", ",", "R"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"NIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", "r"], 
                   RowBox[{"2", " ", "\[Pi]", " ", "rp", " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "+", "rp", "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}], ")"}], " ", 
                    RowBox[{"n", "[", "rp", "]"}]}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"rp", ",", "0", ",", 
                    RowBox[{"R", "-", "r"}]}], "}"}]}], "]"}], "+", 
                RowBox[{"NIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", "r"], 
                   RowBox[{"2", " ", "\[Pi]", " ", "rp", " ", 
                    RowBox[{"(", 
                    RowBox[{"R", "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}], ")"}], " ", 
                    RowBox[{"n", "[", "rp", "]"}]}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"rp", ",", 
                    RowBox[{"R", "-", "r"}], ",", 
                    RowBox[{"R", "+", "r"}]}], "}"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                FractionBox["1", "r"], 
                RowBox[{"2", " ", "\[Pi]", " ", "rp", " ", 
                 RowBox[{"(", 
                  RowBox[{"R", "-", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}], ")"}], " ", 
                 RowBox[{"n", "[", "rp", "]"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"rp", ",", 
                 RowBox[{"r", "-", "R"}], ",", 
                 RowBox[{"r", "+", "R"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getWxcNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", 
       "\"\<CALCULATING WxcNLR via the vxcNLR direct-density piece\>\"", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vxcNLRdirect", "=", 
       RowBox[{"BuildSpline", "[", "getvxcNLRdirectpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"WxcNLR", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"r", "^", "2"}]}], ")"}], " ", 
          RowBox[{"vxcNLRdirect", "[", "r", "]"}], " ", 
          RowBox[{"n", "[", "r", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvxcNLRbacknpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "R", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"integrate", " ", "over", " ", 
          RowBox[{"r", "'"}]}], ":", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"r", "'"}], "]"}], "/"}]}], "|", 
          RowBox[{"r", "-", 
           RowBox[{"r", "'"}]}], "|", " ", 
          RowBox[{
          "in", " ", "a", " ", "sphere", " ", "of", " ", "radius", " ", "R", 
           RowBox[{"(", 
            RowBox[{"r", "'"}], ")"}], " ", "concentric", " ", "with", " ", 
           "position", " ", 
           RowBox[{"r", "'"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ")"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", "<", "10*^-12"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"if", " ", "r", " ", "is", " ", "zero"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"R", "=", 
                RowBox[{"Rnl", "[", "rp", "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"R", "<", "rp"}]}], "}"}], "}"}], ",", 
                 RowBox[{"4", " ", "Pi", " ", "rp"}]}], "]"}]}], ")"}], 
             RowBox[{"n", "[", "rp", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"if", " ", "r", " ", "is", " ", "nonzero"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"R", "=", 
                RowBox[{"Rnl", "[", "rp", "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"R", "<", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "r"], 
                    RowBox[{"2", " ", "\[Pi]", " ", "rp", " ", 
                    RowBox[{"(", 
                    RowBox[{"R", "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{"R", "<", 
                    RowBox[{"r", "+", "rp"}]}]}], "}"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  FractionBox["1", "r"], 
                  RowBox[{"2", " ", "\[Pi]", " ", "rp", " ", 
                   RowBox[{"(", 
                    RowBox[{"r", "+", "rp", "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"r", "-", "rp"}], "]"}]}], ")"}]}]}]}], "]"}]}], 
              ")"}], 
             RowBox[{"n", "[", "rp", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"rp", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getOtherWxcNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "this", " ", "is", " ", "a", " ", "check", " ", "for", " ", "accuracy",
         " ", "of", " ", "the", " ", "back"}], "-", 
       RowBox[{"sphere", " ", "integration"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", 
       "\"\<CALCULATING WxcNLR via the vxcNLR back-density piece...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vxcNLRbackn", "=", 
       RowBox[{"BuildSpline", "[", "getvxcNLRbacknpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "WxcNLR", " ", "can", " ", "technically", " ", "be", " ", "calculated",
         " ", "using", " ", "either", " ", "the", " ", "direct", " ", "or", 
        " ", "back", " ", "\[IndentingNewLine]", "piece", " ", "of", " ", 
        "the", " ", 
        SubsuperscriptBox["v", "xc", "NLR"], " ", "potential"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"OtherWxcNLR", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"r", "^", "2"}]}], ")"}], " ", 
          RowBox[{"vxcNLRbackn", "[", "r", "]"}], " ", 
          RowBox[{"n", "[", "r", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvxcNLRbackRpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "func", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"func", "[", "rp_", "]"}], ":=", 
         RowBox[{
          RowBox[{"n", "[", "rp", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"Rnl", "[", "rp", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BackNLRSphereIntegrate", "[", 
         RowBox[{"func", ",", "r"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvxcNLRpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getvxcNLRdirectpoint", "[", "r", "]"}], "+", 
      RowBox[{"getvxcNLRbacknpoint", "[", "r", "]"}], "+", 
      RowBox[{"getvxcNLRbackRpoint", "[", "r", "]"}]}], "\[IndentingNewLine]",
      ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"when", " ", "doing", " ", "things", " ", "self"}], "-", 
      "consistently"}], ",", " ", 
     RowBox[{
     "it", " ", "may", " ", "be", " ", "better", " ", "to", " ", "build", " ",
       "a", " ", "spline", " ", "out", "\[IndentingNewLine]", "of", " ", 
      "the", " ", "sum", " ", "of", " ", "all", " ", "three", " ", 
      "contributions"}], ",", " ", 
     RowBox[{
     "rather", " ", "than", " ", "three", " ", "splines", " ", "of", " ", 
      "each", " ", "individual", " ", 
      RowBox[{"piece", ".", "\[IndentingNewLine]", "this"}], " ", "is", " ", 
      "because", " ", "the", " ", "individual", " ", "parts", " ", "of", " ", 
      "the", " ", "potentials", " ", "have", " ", "more", " ", "dynamic", " ",
       "features"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "but", " ", "together", " ", "they", " ", "tend", " ", "to", " ", "wash",
       " ", 
      RowBox[{"out", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"getvxcNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", "\"\<CALCULATING vxcNLR...\>\"", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vxcNLR", "=", 
       RowBox[{"BuildSpline", "[", "getvxcNLRpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "vxcNLR"}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"or", " ", "even", " ", "better", " ", "yet"}], ",", " ", 
     RowBox[{"add", " ", "in", " ", "Hartree"}], ",", " ", 
     RowBox[{"too", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getvHxcNLRpoint", "[", "r_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getvHpoint", "[", "r", "]"}], "+", 
      RowBox[{"getvxcNLRdirectpoint", "[", "r", "]"}], "+", 
      RowBox[{"getvxcNLRbacknpoint", "[", "r", "]"}], "+", 
      RowBox[{"getvxcNLRbackRpoint", "[", "r", "]"}]}], "\[IndentingNewLine]",
      ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"getvHxcNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", "\"\<CALCULATING vHxcNLR...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"vHxcNLR", "=", 
       RowBox[{"BuildSpline", "[", "getvHxcNLRpoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "vHxcNLR"}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"getvsNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"getvHxcNLR", ";", "\[IndentingNewLine]", 
      RowBox[{"vsNLR", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"r", ",", 
         RowBox[{
          RowBox[{"v", "[", "r", "]"}], "+", 
          RowBox[{"vHxcNLR", "[", "r", "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Grid", " ", "diagonalization"}], " ", "-", " ", 
      RowBox[{"setup", " ", "and", " ", "routines"}]}], " ", "*)"}], 
    "Subtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"INIT", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "roughly", " ", "good", " ", "parameters", " ", "for", " ", 
         "different", " ", "orders", " ", "and", " ", "grid", " ", "counts"}],
         "..."}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SECOND", " ", "ORDER", " ", "STUFF"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Ngrid", " ", "=", " ", "100"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.0694", "/", "Z"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Ngrid", " ", "=", " ", "200"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.06923", "*", 
         RowBox[{
          RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Ngrid", " ", "=", " ", "400"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.06905", "*", 
         RowBox[{
          RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Ngrid", " ", "=", " ", "800"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.06891", "*", 
         RowBox[{
          RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"FOURTH", " ", "ORDER", " ", "STUFF"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Ngrid", " ", "=", " ", "200"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.00091", "*", 
         RowBox[{
          RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Ngrid", " ", "=", " ", "400"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GRIDdelta", "=", 
        RowBox[{"0.00085", "*", 
         RowBox[{
          RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ";"}], " ", 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"FOURTHorder", ",", "\[IndentingNewLine]", 
        RowBox[{"GRIDdelta", "=", 
         RowBox[{"0.00085", "*", 
          RowBox[{
           RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GRIDdelta", "=", 
         RowBox[{"0.06891", "*", 
          RowBox[{
           RowBox[{"100", "/", "Ngrid"}], "/", "Z"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SPARSEGRIDdelta", "=", "GRIDdelta"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MULTIPLIER", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAXr", "/", "GRIDdelta"}], "-", " ", "Ngrid"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Ngrid", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Ngrid", "-", "1"}], ")"}], "/", "2"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SPARSEmultiplier", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAXr", "/", "SPARSEGRIDdelta"}], "-", " ", "SPARSENgrid"}],
          ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"SPARSENgrid", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SPARSENgrid", "-", "1"}], ")"}], "/", "2"}]}], ")"}]}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PrintPermanentDEBUG", "[", 
       RowBox[{"\"\<Grid now \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"GRIDmin", ",", "GRIDmax"}], "}"}], ",", 
          RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], "<>", 
        "\"\< with \>\"", "<>", 
        RowBox[{"ToString", "[", "Ngrid", "]"}], "<>", "\"\< points.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rtable", "=", "rTABLE"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]table", "=", "\[CapitalDelta]TABLE"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sparsertable", "=", "SPARSErTABLE"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"FOURTHorder", ",", "\[IndentingNewLine]", 
        RowBox[{"KE", "=", "getFourthOrderKE"}], ",", "\[IndentingNewLine]", 
        RowBox[{"KE", "=", "getSecondOrderKE"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIAG", "[", "vs_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintPermanentDEBUG", "[", "\"\<Diagonalizing s orbitals! ...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{"Diagonalization", " ", "routine"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"howmany", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"howmany", ",", 
         RowBox[{"Length", "[", "soccupy", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"vs", "[", "r", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "rtable"}], "}"}]}], "]"}], "]"}], "+", 
        "KE"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Heig", ",", "Hvec"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{"Eigensystem", "[", 
             RowBox[{"H", "//", "N"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
            RowBox[{"Re", "[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Heig", "=", 
       RowBox[{"Heig", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "howmany"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintPermanentDEBUG", "[", 
       RowBox[{"\"\<s eigenvalues = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Heig", ",", 
          RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Hvec", "=", 
       RowBox[{"Hvec", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "howmany"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "howmany"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Hvec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", " ", "Pi", " ", 
              RowBox[{"rtable", "^", "2"}]}], ")"}], "*", 
            "\[CapitalDelta]table", "*", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Hvec", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}]}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "s", " ", "orbital", " ", "things"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Ts", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "soccupy", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Ts", "+=", 
         RowBox[{
          RowBox[{"soccupy", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", " ", "Pi", " ", 
               RowBox[{"rtable", "^", "2"}]}], ")"}], "\[CapitalDelta]table", 
             "*", 
             RowBox[{"Conjugate", "[", 
              RowBox[{"Hvec", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"KE", ".", 
             RowBox[{"Hvec", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"soccupy", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Hvec", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "soccupy", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "poccupy", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"howmany", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"howmany", ",", 
            RowBox[{"Length", "[", "poccupy", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
         "PrintPermanentDEBUG", "[", "\"\<Diagonalizing p orbitals! ...\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"H", "=", 
          RowBox[{
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"vs", "[", "r", "]"}], "+", 
               RowBox[{"l", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"l", "+", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", " ", 
                   RowBox[{"r", "^", "2"}]}], ")"}]}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "rtable"}], "}"}]}], "]"}], "]"}], "+", 
           "KE"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pHeig", ",", "pHvec"}], "}"}], "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Chop", "[", 
               RowBox[{"Eigensystem", "[", 
                RowBox[{"H", "//", "N"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
               RowBox[{"Re", "[", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pHeig", "=", 
          RowBox[{"pHeig", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "howmany"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<p eigenvalues = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"pHeig", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pHvec", "=", 
          RowBox[{"pHvec", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "howmany"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "howmany"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pHvec", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", " ", "Pi", " ", 
                 RowBox[{"rtable", "^", "2"}]}], ")"}], "*", 
               "\[CapitalDelta]table", "*", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"pHvec", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}]}], "]"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "get", " ", "density", " ", "on", " ", "a", " ", "grid", " ", "and",
            " ", "convert", " ", "to", " ", "interpolation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dens", "+=", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"poccupy", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"pHvec", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "poccupy", "]"}]}], "}"}]}], "]"}]}], 
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "Kinetic", " ", "energy"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "poccupy", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Ts", "+=", 
            RowBox[{
             RowBox[{"poccupy", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", " ", "Pi", " ", 
                  RowBox[{"rtable", "^", "2"}]}], ")"}], 
                "\[CapitalDelta]table", "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"pHvec", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"KE", ".", 
                 RowBox[{"pHvec", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"l", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"l", "+", "1"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"rtable", "^", "2"}]}], ")"}]}], "*", 
                 RowBox[{"pHvec", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dens0", "=", 
       RowBox[{
        RowBox[{"dens", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"GRIDdelta", 
         RowBox[{"(", "   ", 
          RowBox[{"(", "  ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dens", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"dens", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"GRIDdelta", 
              RowBox[{"(", 
               RowBox[{"1", "+", "MULTIPLIER"}], ")"}]}], ")"}]}], "  ", 
           ")"}], "    ", ")"}]}]}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "dens0"}], "}"}], "}"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"rtable", ",", "dens"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "PrintPermanentDEBUG", "[", 
       "\"\<getting diag-density on coarse grid\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"n", "=", 
       RowBox[{"BuildSpline", "[", "n", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "only", " ", "get", " ", "density", " ", "to", " ", "specified", " ", 
        "tolerance"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PrintPermanentDEBUG", "[", 
       RowBox[{"\"\<diag-density normalization = \>\"", ",", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", "[", "r", "]"}], 
           RowBox[{"(", 
            RowBox[{"4", " ", "Pi", " ", 
             RowBox[{"r", "^", "2"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "get", " ", "potential", " ", "energy", " ", "with", " ", "real", " ",
          "external", " ", "potential"}], ",", " ", 
        RowBox[{"not", " ", "the", " ", "KS", " ", "potential"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"r", "^", "2"}]}], ")"}], 
          RowBox[{"n", "[", "r", "]"}], 
          RowBox[{"v", "[", "r", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"print", " ", "out", " ", "stuff"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"PrintPermanentDEBUG", "[", 
       RowBox[{"\"\<Ts = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Ts", ",", 
          RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"PrintPermanentDEBUG", "[", 
       RowBox[{"\"\< V = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"V", ",", 
          RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Heig", ",", "Hvec"}], "}"}]}], "\[IndentingNewLine]", ")"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Self", "-", 
      RowBox[{"consistent", " ", "KS", " ", "scheme"}]}], " ", "*)"}], 
    "Subtitle"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"KSNLR", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ne", "=", 
       RowBox[{
        RowBox[{"Total", "[", "soccupy", "]"}], "+", 
        RowBox[{"Total", "[", "poccupy", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"\"\<KS-NLR calculation for Z = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Z", ",", 
            RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], "<>", 
          "\"\<, s occupation = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"soccupy", ",", 
            RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], "<>", 
          "\"\<, p occupation = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"poccupy", ",", 
            RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], ",",
          "Red", ",", "Large"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "you", " ", "must", " ", "have", " ", "any", " ", "density", " ", 
         "function", " ", 
         RowBox[{"n", "[", "r", "]"}], " ", "defined", " ", "for", " ", 
         "input", " ", "for", " ", "this", " ", "to", " ", "work"}], "..."}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CONVERGED", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"start", " ", "on", " ", "a", " ", "coarse", " ", 
        RowBox[{"grid", "/", "tolerance"}], " ", "and", " ", "refine", " ", 
        "your", " ", "way", " ", "to", " ", "convergence"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FUNCTIONtolerance", "=", "INITIALfunctionTOLERANCE"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ngrid", "=", "INITIALNgrid"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SPARSENgrid", "=", 
       RowBox[{"Ngrid", "/", "4"}]}], ";", "\[IndentingNewLine]", "INIT", ";",
       "\[IndentingNewLine]", 
      RowBox[{"Ts", "=", 
       RowBox[{"-", "1234"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", "1234"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"oldTs", "=", "1234"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "the", " ", "value", " ", "of", " ", "Ts", " ", "for", " ", "a", " ",
           "KS"}], "-", "scheme", "-", 
         RowBox[{"converged", " ", "density"}]}], ",", " ", 
        RowBox[{"for", " ", "a", " ", "given", " ", "grid"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"oldV", "=", 
       RowBox[{"-", "1234"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "value", " ", "of", " ", "V", " ", "for", " ", "a", " ", "KS"}], "-", 
        "scheme", "-", 
        RowBox[{"converged", " ", "density"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "PrintPermanentDEBUG", "[", 
       "\"\<Beginning KS-NLR self-consistent cycle\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iters", "=", "1"}], ",", 
        RowBox[{"iters", "\[LessEqual]", "KSitermax"}], ",", 
        RowBox[{"iters", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PrintPermanentDEBUG", "[", "\"\< \>\"", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"INDENT", ",", 
            RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<KS-NLR iteration \>\"", "<>", 
           RowBox[{"ToString", "[", "iters", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"norm", "=", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "r", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"4", " ", "Pi", " ", 
               RowBox[{"r", "^", "2"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<input density norm is \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"norm", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"norm", "=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", " ", "Pi", " ", 
              RowBox[{"rtable", "^", "2"}]}], ")"}], "*", 
            "\[CapitalDelta]table", " ", "*", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"n", "[", "r", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "rtable"}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<by grid efforts: \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"norm", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
         "PrintPermanentDEBUG", "[", "\"\<renormalizing input density\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"inn", "=", 
          RowBox[{"BuildSpline", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "#1", "]"}], "*", 
             RowBox[{"Ne", "/", "norm"}]}], "&"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"input", " ", "density"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"INDENT", ",", 
            RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"getting", " ", "the", " ", "KS", " ", "potential"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"norm", ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"getRnl", ";", "\[IndentingNewLine]", 
            RowBox[{"vsNLR", "=", "getvsNLR"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"vsNLR", "=", "v"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"DIAG", "[", "vsNLR", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"norm", "=", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "r", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"4", " ", "Pi", " ", 
               RowBox[{"r", "^", "2"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<output density norm is \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"norm", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"norm", "=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", " ", "Pi", " ", 
              RowBox[{"rtable", "^", "2"}]}], ")"}], "*", 
            "\[CapitalDelta]table", " ", "*", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"n", "[", "r", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "rtable"}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{"\"\<by grid efforts: \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"norm", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
         "PrintPermanentDEBUG", "[", "\"\<renormalizing output density\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outn", "=", 
          RowBox[{"BuildSpline", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "#1", "]"}], "*", 
             RowBox[{"Ne", "/", "norm"}]}], "&"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"input", " ", "density"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"INDENT", "=", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"INDENT", ",", 
            RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"V", "=", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "Pi", " ", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"n", "[", "r", "]"}], 
             RowBox[{"v", "[", "r", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"convergence", "=", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"4", " ", "Pi", " ", 
             RowBox[{"r", "^", "2"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"inn", "[", "r", "]"}], "-", 
                RowBox[{"outn", "[", "r", "]"}]}], ")"}], "^", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrintPermanentDEBUG", "[", 
          RowBox[{
          "\"\<\[Integral]\!\(\*SuperscriptBox[\(d\), \(3\)]\)r \
(\!\(\*SubscriptBox[\(n\), \(in\)]\)(r)-\!\(\*SubscriptBox[\(n\), \
\(out\)]\)(r)\!\(\*SuperscriptBox[\()\), \(2\)]\) = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"convergence", ",", 
             RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"convergence", "<", "KSdensitytolerance"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"we", " ", "have", " ", 
             RowBox[{"converged", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Ngrid", "<", "FINALNgrid"}], " ", "||", " ", 
              RowBox[{
              "FUNCTIONtolerance", " ", ">", " ", 
               "FINALfunctionTOLERANCE"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "but", " ", "not", " ", "yet", " ", "on", " ", "the", " ", 
               "smallest", " ", "grid"}], " ", "*)"}], "\[IndentingNewLine]", 
             
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"oldTs", "-", "Ts"}], "]"}], "<", 
                 "KSenergytolerance"}], "&&", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"oldV", "-", "V"}], "]"}], "<", 
                 "KSenergytolerance"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "nevertheless", " ", "the", " ", "energy", " ", "appears", 
                 " ", "not", " ", "to", " ", "be", " ", "changing"}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "PrintPermanentDEBUG", "[", 
                 "\"\<   within tolerance, and grid seems ok (energy stopped \
changing)\>\"", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"CONVERGED", "=", "True"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "PrintPermanentDEBUG", "[", 
                 "\"\<   within tolerance, but grid not fine enough.  \
refining...\>\"", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                  "only", " ", "update", " ", "the", " ", "old", " ", 
                   RowBox[{"Ts", "/", "V"}], " ", "if", " ", "we", " ", "are",
                    " ", "changing", " ", "the", " ", "grid", " ", 
                   "spacing"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                  "that", " ", "way", " ", "the", " ", "energy", " ", 
                   "comparison", " ", "above", " ", "makes", " ", "sense"}], 
                  ";", " ", 
                  RowBox[{
                   RowBox[{"it", "'"}], "s", " ", "comparing", 
                   "\[IndentingNewLine]", "between", " ", "two", " ", 
                   "different", " ", "grids", " ", "with", " ", 
                   "\"\<converged\>\"", " ", 
                   RowBox[{"densities", "."}]}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"oldTs", "=", "Ts"}], ";", "\[IndentingNewLine]", 
                RowBox[{"oldV", "=", "V"}], ";", "\[IndentingNewLine]", 
                RowBox[{"FUNCTIONtolerance", "=", 
                 RowBox[{"2.0", "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"1", "/", "FUNCTIONtolerance"}], "+", 
                    RowBox[{"1", "/", "FINALfunctionTOLERANCE"}]}], ")"}]}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"Ngrid", "=", 
                 RowBox[{"Ceiling", "[", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Ngrid", "*", "FINALNgrid"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"SPARSENgrid", "=", 
                 RowBox[{"Ceiling", "[", 
                  RowBox[{"Ngrid", "/", "4"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "INIT", ";"}]}], "\[IndentingNewLine]",
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "we", " ", "are", " ", "converged", " ", "and", " ", "all", " ",
                "the", " ", "way", " ", "to", " ", "the", " ", "final", " ", 
               RowBox[{"grid", "!"}], "  ", "Break", " ", 
               RowBox[{"time", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CONVERGED", "=", "True"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PrintPermanentDEBUG", "[", 
             RowBox[{"\"\<   but not within tolerance of \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"KSdensitytolerance", ",", 
                RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "also", " ", "linearly", " ", "mix", " ", "the", " ", 
              "densities", " ", 
              RowBox[{"(", 
               RowBox[{"boring", " ", "algorithm"}], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"nnew", "=", 
             RowBox[{"Function", "[", 
              RowBox[{"r", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", "KSlambda", ")"}], 
                 RowBox[{"outn", "[", "r", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "KSlambda"}], ")"}], " ", 
                 RowBox[{"inn", "[", "r", "]"}]}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
            "PrintPermanentDEBUG", "[", "\"\<building next input density\>\"",
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"INDENT", "=", 
             RowBox[{"INDENT", "<>", "\"\<   \>\""}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"n", "=", 
             RowBox[{"BuildSpline", "[", "nnew", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"INDENT", "=", 
             RowBox[{"StringDrop", "[", 
              RowBox[{"INDENT", ",", 
               RowBox[{"-", "3"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PrintPermanentDEBUG", "[", 
       "\"\<Ending KS-NLR self-consistent cycle\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"INDENT", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"INDENT", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CONVERGED", ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<KS-NLR converged in \>\"", "<>", 
            RowBox[{"ToString", "[", "iters", "]"}], "<>", 
            "\"\< iterations.\>\""}], ",", "Blue"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<KS-NLR \!\(\*
StyleBox[\"FAILED\",
FontSlant->\"Italic\"]\) to converge in \>\"", "<>", 
            RowBox[{"ToString", "[", "iters", "]"}], "<>", 
            "\"\< iterations.\>\""}], ",", "Red"}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<s eigenvalues = \>\"", ",", "Heig"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<p eigenvalues = \>\"", ",", "pHeig"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"norm", ">", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<    Ts = \>\"", ",", "Ts"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<     V = \>\"", ",", 
           RowBox[{"V", "=", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", " ", "Pi", " ", 
                 RowBox[{"r", "^", "2"}]}], ")"}], 
               RowBox[{"n", "[", "r", "]"}], 
               RowBox[{"v", "[", "r", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "0", ",", "MAXr"}], "}"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<    WH = \>\"", ",", "getWH"}], "]"}], ";", 
         "\[IndentingNewLine]", "getRnl", ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<WxcNLR = \>\"", ",", "getWxcNLR"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\< EvNLR = \>\"", ",", 
           RowBox[{"V", "+", "Ts", "+", "WH", "+", "WxcNLR"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "getvxcNLR", ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"4", " ", "Pi", " ", 
               SuperscriptBox["r", "2"], 
               RowBox[{"n", "[", "r", "]"}]}], ",", 
              RowBox[{"vxcNLR", "[", "r", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "10"}], "}"}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", 
             "\"\<4\!\(\*SuperscriptBox[\(\[Pi]r\), \(2\)]\) n(r) and \
\!\(\*SubsuperscriptBox[\(v\), \(xc\), \(NLR\)]\)(r)\>\""}]}], "]"}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"one", " ", "or", " ", "fewer", " ", "electrons"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<    Ts = \>\"", ",", "Ts"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<     V = \>\"", ",", "V"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\< EvNLR = \>\"", ",", 
           RowBox[{"V", "+", "Ts"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6113884260297956`*^9, 3.611388479990405*^9}, 
   3.61138852132969*^9, {3.611388584759404*^9, 3.611388599336753*^9}, {
   3.611388646637209*^9, 3.611388688724678*^9}, {3.611388762413844*^9, 
   3.611388770805621*^9}, {3.611388815687498*^9, 3.611388844729883*^9}, {
   3.611388932138085*^9, 3.611388941049263*^9}, {3.611388981608673*^9, 
   3.611388992784233*^9}, {3.611389222836814*^9, 3.6113892236507597`*^9}, {
   3.6113907967377577`*^9, 3.611390881104198*^9}, {3.611393366776848*^9, 
   3.6113933703739033`*^9}, {3.611408177016507*^9, 3.611408313365601*^9}, 
   3.611408345200735*^9, {3.611408377812975*^9, 3.6114085064950953`*^9}, {
   3.61140942916779*^9, 3.6114094836137953`*^9}, {3.6114095463385983`*^9, 
   3.611409563165182*^9}, {3.611409646823782*^9, 3.611409740016992*^9}, {
   3.611410241065405*^9, 3.611410377705586*^9}, {3.611410486376935*^9, 
   3.611410516556889*^9}, {3.6114107109125032`*^9, 3.611410715127677*^9}, {
   3.6114109314599667`*^9, 3.611410972126842*^9}, {3.6114112884294043`*^9, 
   3.611411299876466*^9}, {3.611411488247553*^9, 3.6114114944893*^9}, {
   3.61141167727098*^9, 3.611411703847191*^9}, {3.61147507344631*^9, 
   3.611475084820263*^9}, {3.611475824361311*^9, 3.6114759953494377`*^9}, {
   3.6114760262136803`*^9, 3.6114763376306067`*^9}, {3.611476470256637*^9, 
   3.611476489664791*^9}, {3.6114765259727583`*^9, 3.611476565349478*^9}, {
   3.611476669880898*^9, 3.6114766884644814`*^9}, {3.611476908039967*^9, 
   3.61147690820753*^9}, {3.6114770353432837`*^9, 3.611477121789185*^9}, {
   3.611477274766787*^9, 3.6114772752468777`*^9}, {3.6114773451943283`*^9, 
   3.611477374956635*^9}, {3.6114774101641006`*^9, 3.61147743905366*^9}, {
   3.611477544862446*^9, 3.611477641654552*^9}, {3.6114777805408707`*^9, 
   3.6114778212829247`*^9}, {3.611477863974579*^9, 3.6114778728553677`*^9}, {
   3.611477939539283*^9, 3.611477962731563*^9}, {3.611478023173264*^9, 
   3.6114780248134108`*^9}, {3.6114780714494753`*^9, 3.611478121497072*^9}, {
   3.611478199112825*^9, 3.611478205839039*^9}, {3.611478506132154*^9, 
   3.611478548858267*^9}, {3.6114785834880857`*^9, 3.611478592238408*^9}, {
   3.611478635509337*^9, 3.61147864994868*^9}, {3.611479240283566*^9, 
   3.611479306313677*^9}, {3.611480158305744*^9, 3.6114801683943157`*^9}, {
   3.611480219000153*^9, 3.611480221433888*^9}, {3.6114803771381063`*^9, 
   3.6114803962699537`*^9}, {3.611480626374505*^9, 3.611480638107374*^9}, {
   3.611480725904295*^9, 3.6114807260188*^9}, {3.611480822684658*^9, 
   3.611480824182508*^9}, {3.6114808790282793`*^9, 3.611481225045268*^9}, {
   3.6114812669252663`*^9, 3.611481273562746*^9}, {3.611481315415769*^9, 
   3.611481362365007*^9}, {3.611481581310471*^9, 3.611481660498074*^9}, {
   3.611491835256898*^9, 3.611491938696423*^9}, {3.611492017760158*^9, 
   3.611492126707967*^9}, {3.6114934457411747`*^9, 3.6114934834322443`*^9}, {
   3.611494491545076*^9, 3.6114945470767927`*^9}, {3.611494585268806*^9, 
   3.611494607507073*^9}, {3.611494720559889*^9, 3.61149487284515*^9}, {
   3.611495461437221*^9, 3.611495470610136*^9}, {3.611495510215188*^9, 
   3.6114956645624866`*^9}, {3.611496524484215*^9, 3.6114965872491903`*^9}, {
   3.6114967506800117`*^9, 3.611496765308569*^9}, {3.611496804358073*^9, 
   3.611496873262788*^9}, {3.61149706750633*^9, 3.611497110974771*^9}, {
   3.611497256818143*^9, 3.611497270782991*^9}, {3.611497495334297*^9, 
   3.6114974992383823`*^9}, {3.611497731522141*^9, 3.611497731623502*^9}, {
   3.611497787838489*^9, 3.611497788342972*^9}, 3.61149788279322*^9, {
   3.611550042278865*^9, 3.61155009300797*^9}, {3.611550146289913*^9, 
   3.611550273941539*^9}, {3.611550318341454*^9, 3.6115503533611193`*^9}, {
   3.611550457314927*^9, 3.6115505602408733`*^9}, {3.611550718852274*^9, 
   3.6115507706690483`*^9}, {3.61155082855265*^9, 3.611550835477612*^9}, {
   3.6115510565038157`*^9, 3.61155112111273*^9}, {3.611551154808371*^9, 
   3.6115512076003036`*^9}, {3.6115512778334103`*^9, 3.611551284188098*^9}, {
   3.6115513463556747`*^9, 3.611551460502202*^9}, {3.611551497103552*^9, 
   3.611551626543227*^9}, {3.611551659639305*^9, 3.611551835892397*^9}, {
   3.6115518896861753`*^9, 3.611551945042081*^9}, {3.611551990468506*^9, 
   3.611552067500684*^9}, {3.611552128991988*^9, 3.611552163197205*^9}, {
   3.611552981938898*^9, 3.611553023762282*^9}, {3.61155309820616*^9, 
   3.611553143633062*^9}, {3.611553183226212*^9, 3.611553242114862*^9}, {
   3.6115533589306507`*^9, 3.6115533771341333`*^9}, {3.611553596135697*^9, 
   3.611553611438901*^9}, {3.611553671448059*^9, 3.6115537087265587`*^9}, {
   3.6115541021375427`*^9, 3.611554360305231*^9}, {3.6115543973061247`*^9, 
   3.6115544430749683`*^9}, {3.6115545605655203`*^9, 
   3.6115547276965523`*^9}, {3.61155482501967*^9, 3.611554859576973*^9}, {
   3.611554920689945*^9, 3.611554920883127*^9}, {3.611555064378302*^9, 
   3.61155509666193*^9}, 3.611555255365035*^9, {3.611555315084284*^9, 
   3.61155534696668*^9}, {3.6115554163257504`*^9, 3.6115554259586277`*^9}, {
   3.61155633766947*^9, 3.61155640598584*^9}, {3.6115564962463217`*^9, 
   3.6115564978751497`*^9}, {3.61155662111686*^9, 3.61155662139935*^9}, {
   3.611556683632255*^9, 3.6115566894783783`*^9}, {3.611556752304438*^9, 
   3.6115567719154387`*^9}, {3.611557082766214*^9, 3.611557154198975*^9}, {
   3.611557187915208*^9, 3.611557193828721*^9}, {3.611557229280164*^9, 
   3.6115572769105387`*^9}, {3.61155732561558*^9, 3.611557358331949*^9}, {
   3.6115575596050873`*^9, 3.611557585590146*^9}, {3.611557636373701*^9, 
   3.611557811661991*^9}, {3.611557843980372*^9, 3.611557915833836*^9}, {
   3.6115579723639107`*^9, 3.611557986892864*^9}, {3.611558128487952*^9, 
   3.6115581385272818`*^9}, 3.611558191771895*^9, {3.611558243596136*^9, 
   3.6115582657146606`*^9}, {3.611558296594377*^9, 3.611558358998692*^9}, {
   3.611558389340624*^9, 3.611558487755722*^9}, {3.6115585484773912`*^9, 
   3.611558791700527*^9}, {3.611558840373728*^9, 3.6115588888031807`*^9}, 
   3.611558961417507*^9, {3.611558992376238*^9, 3.611559106150469*^9}, {
   3.611559158827799*^9, 3.611559182186349*^9}, {3.611559212998767*^9, 
   3.611559496621881*^9}, {3.611559535887507*^9, 3.611559665064149*^9}, {
   3.611559745870319*^9, 3.6115597466330223`*^9}, {3.611559792714767*^9, 
   3.6115600287320337`*^9}, {3.6115600684504547`*^9, 3.611560489699296*^9}, {
   3.611560788410921*^9, 3.6115609177253103`*^9}, {3.611560959270578*^9, 
   3.611561016743575*^9}, {3.61156108405555*^9, 3.611561098389442*^9}, {
   3.611561137683084*^9, 3.611561200777659*^9}, {3.61156139719801*^9, 
   3.611561400976754*^9}, {3.61156159298088*^9, 3.6115616148263597`*^9}, {
   3.611561652385879*^9, 3.611561675854746*^9}, {3.611561739797228*^9, 
   3.61156178557808*^9}, {3.611561856752351*^9, 3.61156193227595*^9}, {
   3.611561968377201*^9, 3.611562007965664*^9}, {3.6115621634897738`*^9, 
   3.611562164380921*^9}, {3.611562579036981*^9, 3.611562620672002*^9}, {
   3.611562724213398*^9, 3.611562735359973*^9}, {3.6115634114423122`*^9, 
   3.6115634218366137`*^9}, {3.611563548868528*^9, 3.611563550006654*^9}, {
   3.6115636480309477`*^9, 3.611563648749105*^9}, {3.61156370622608*^9, 
   3.6115638183292503`*^9}, {3.6115645398004313`*^9, 3.611564611782116*^9}, {
   3.611564714218362*^9, 3.611564714589409*^9}, {3.611564922441484*^9, 
   3.6115651509684763`*^9}, {3.611565214699888*^9, 3.611565264841219*^9}, {
   3.611565301124086*^9, 3.6115653139848423`*^9}, {3.611565433110302*^9, 
   3.611565504281138*^9}, {3.611565561817678*^9, 3.6115655732838297`*^9}, {
   3.611565612939328*^9, 3.611565703592654*^9}, 3.611565978920899*^9, {
   3.61156621691823*^9, 3.6115662218752537`*^9}, {3.611566323276784*^9, 
   3.611566328533382*^9}, {3.611566444189723*^9, 3.611566530619381*^9}, {
   3.6115665711881742`*^9, 3.6115668438512783`*^9}, {3.6115672187233562`*^9, 
   3.611567238777815*^9}, {3.611567429147668*^9, 3.611567439896302*^9}, {
   3.611567648693882*^9, 3.611567686312642*^9}, {3.6115677598554*^9, 
   3.611567777800542*^9}, {3.611567828111721*^9, 3.611567857117235*^9}, {
   3.611567889770713*^9, 3.611567935464635*^9}, {3.611568071795555*^9, 
   3.6115681959573936`*^9}, {3.611568248770646*^9, 3.611568256622074*^9}, {
   3.611568295156629*^9, 3.611568323906537*^9}, {3.61156837211585*^9, 
   3.611568401376935*^9}, {3.611568432972711*^9, 3.6115685028732567`*^9}, {
   3.6115686588560123`*^9, 3.611568762843173*^9}, {3.6115700040811157`*^9, 
   3.6115700225015097`*^9}, {3.611570304543807*^9, 3.6115703366544437`*^9}, {
   3.611570405872147*^9, 3.611570445179285*^9}, {3.611804743760079*^9, 
   3.61180479447093*^9}, {3.611804894334807*^9, 3.6118049316779013`*^9}, {
   3.6118213282359133`*^9, 3.61182133624962*^9}, {3.612014501562427*^9, 
   3.612014653575148*^9}, {3.612014758529829*^9, 3.612014760397217*^9}, {
   3.6120150050365562`*^9, 3.612015044862611*^9}, {3.6120200636619368`*^9, 
   3.612020067013941*^9}, {3.612020154439989*^9, 3.612020283024788*^9}, {
   3.612020315546905*^9, 3.612020416590996*^9}, {3.612021361782879*^9, 
   3.6120213708201637`*^9}, {3.612021409109192*^9, 3.6120214307489853`*^9}, {
   3.612021577887373*^9, 3.612021599906546*^9}, {3.6120272725315533`*^9, 
   3.612027305720579*^9}, {3.612064273371189*^9, 3.61206438034356*^9}, {
   3.61208951858634*^9, 3.612089559034711*^9}, {3.6120896050752363`*^9, 
   3.6120896093795223`*^9}, {3.612089924366549*^9, 3.612089924813669*^9}, {
   3.612090302602558*^9, 3.612090335003498*^9}, {3.6120904388361273`*^9, 
   3.6120904917204123`*^9}, {3.612273589198831*^9, 3.6122736563619328`*^9}, {
   3.612273778253292*^9, 3.612273781117631*^9}, {3.6122738137538567`*^9, 
   3.612273840239511*^9}, {3.612273907658451*^9, 3.612273909998258*^9}, {
   3.612274056490274*^9, 3.612274061830143*^9}, {3.612318323508212*^9, 
   3.61231833235217*^9}, {3.612351212678261*^9, 3.612351243205449*^9}, {
   3.612618976930971*^9, 3.6126189861414347`*^9}, {3.617450449613915*^9, 
   3.617450472850724*^9}, {3.617450531871849*^9, 3.6174505746460114`*^9}, {
   3.617450664852466*^9, 3.617450708158971*^9}, 3.617450757499655*^9, {
   3.6174511184398127`*^9, 3.617451151460244*^9}, {3.6174515876283407`*^9, 
   3.617451651769137*^9}, {3.617451687585176*^9, 3.617451793051394*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
(* 
Simple diagonalization test: \[LineSeparator]Hydrogen atom with 2 \
non-interacting electrons 
*)\
\>", "Title",
 CellChangeTimes->{{3.6114805451317587`*^9, 3.611480549950823*^9}, {
   3.611491806422473*^9, 3.611491807438725*^9}, {3.611556623988593*^9, 
   3.611556670840457*^9}, {3.611561488173917*^9, 3.611561492352397*^9}, 
   3.61156612421312*^9, {3.6174512229717913`*^9, 3.617451224609871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"system", " ", "properties"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Z", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "Z"}], "/", "r"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soccupy", "=", 
     RowBox[{"{", "2", "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "how", " ", "many", " ", "electrons", " ", "to", " ", "put", " ", "in", 
       " ", "each", " ", "s", " ", 
       RowBox[{"orbital", ".", "  ", 
        RowBox[{"soccupy", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", "is", " ", "1", "s"}], ",", 
      " ", 
      RowBox[{
       RowBox[{"soccupy", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "2", "s"}], ",", " ", 
      
      RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"poccupy", "=", 
     RowBox[{"{", "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "many", " ", "electrons", " ", "go", " ", "in", " ", "each", 
     " ", "p", " ", 
     RowBox[{"orbital", ".", "  ", "everything"}], " ", "is", " ", 
     "spherically", " ", 
     RowBox[{"averaged", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"howmany", "=", "5"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "many", " ", "eigenfunctions", " ", "to", " ", "keep"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"grid", " ", "properties"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ngrid", "=", "200"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"#", " ", "of", " ", "grid", " ", "points"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"SPARSENgrid", "=", "25"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"#", " ", "of", " ", "sparse", " ", "grid", " ", 
       RowBox[{"points", ":", "  ", 
        RowBox[{
        "attempts", " ", "to", " ", "be", " ", "this", " ", "many", " ", 
         "grid", " ", "points"}]}]}], ",", " ", 
      RowBox[{
      "but", " ", "refines", " ", "if", " ", "necessary", " ", "to", " ", 
       "achieve", " ", 
       RowBox[{"FUNCTIONtolerance", ".", "  ", "Ideally"}], " ", "dividing", 
       " ", "a", " ", "multiple", " ", "of", " ", "two", " ", "from", " ", 
       RowBox[{"Ngrid", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MAXr", "=", 
     RowBox[{"40", "/", "Z"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "far", " ", "out", " ", "to", " ", "go", " ", "in", " ", 
     "the", " ", "grid"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FOURTHorder", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "tolerance", " ", "to", " ", "get", " ", "FUNCTIONS", " ", "to", " ", 
      "in", " ", "BuildSpline"}], ",", " ", 
     RowBox[{"like", " ", 
      SubsuperscriptBox["v", "Hxc", "RNL"], 
      RowBox[{"(", "r", ")"}], " ", "and", " ", 
      SubscriptBox["R", "NL"], 
      RowBox[{"(", "r", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FUNCTIONtolerance", "=", "10*^-7"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Debug", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DEBUG", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUPERdebug", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "INIT", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"initialize", " ", "the", " ", "grid"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIAG", "[", "v", "]"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"just", " ", "diagonalize"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"don", "'"}], "t", " ", "run", " ", "a", " ", "self"}], "-", 
       RowBox[{"consistent", " ", "calculation"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"n", "[", "r", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"try", " ", "plotting", " ", "the", " ", "density"}], " ", "*)"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"getRnl", ";"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Rnl", "[", "r", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "getWxcNLR", "\[IndentingNewLine]", 
   "getOtherWxcNLR", "\[IndentingNewLine]", 
   RowBox[{"getvxcNLR", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vxcNLRbackR", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"vxcNLR", "[", "r", "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vxcNLRdirect", "[", "r", "]"}], "+", 
       RowBox[{"vxcNLRbackn", "[", "r", "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vxcNLRdirect", "[", "r", "]"}], ",", 
       RowBox[{"vxcNLRbackn", "[", "r", "]"}], ",", 
       RowBox[{"vxcNLRbackR", "[", "r", "]"}], ",", 
       RowBox[{"vxcNLR", "[", "r", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Red", "}"}], ",", 
        RowBox[{"{", "Blue", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Green", "]"}], ",", "Dashed"}], "}"}], ",", 
        
        RowBox[{"{", "Black", "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.611388714698894*^9, 3.611388808854856*^9}, 
   3.611388854275363*^9, {3.6113890050778112`*^9, 3.611389165264846*^9}, {
   3.611389205751465*^9, 3.611389206135207*^9}, {3.611389253030107*^9, 
   3.611389321914851*^9}, {3.611389375661326*^9, 3.611389530913155*^9}, {
   3.6113895626893682`*^9, 3.6113896228093863`*^9}, {3.6113896964122562`*^9, 
   3.611389734937792*^9}, {3.611389778561473*^9, 3.6113897824628353`*^9}, {
   3.611389826083428*^9, 3.611389828795879*^9}, {3.611389938512867*^9, 
   3.6113905949973907`*^9}, {3.611390630161414*^9, 3.611390715962439*^9}, {
   3.61139077612901*^9, 3.611390792255003*^9}, {3.611390903879552*^9, 
   3.611390924443972*^9}, 3.611390992231318*^9, {3.6113910666082172`*^9, 
   3.611391425711828*^9}, {3.6113914568932343`*^9, 3.6113916583441973`*^9}, {
   3.611391703428297*^9, 3.611392153568692*^9}, {3.611392187118202*^9, 
   3.611392249735025*^9}, {3.611392286903193*^9, 3.6113923573129683`*^9}, {
   3.611392408796706*^9, 3.611392432476841*^9}, {3.611392476859542*^9, 
   3.611392855671425*^9}, {3.611392904681163*^9, 3.611393464168496*^9}, {
   3.611393516119749*^9, 3.611393521694255*^9}, {3.611393564376315*^9, 
   3.611393639455102*^9}, 3.61140206329591*^9, {3.61140224436905*^9, 
   3.611402306683968*^9}, {3.61140235499207*^9, 3.611402479774124*^9}, {
   3.611402518836916*^9, 3.6114025511290407`*^9}, {3.611402908538412*^9, 
   3.611402918116982*^9}, 3.6114029955726748`*^9, {3.611403052487319*^9, 
   3.611403057557494*^9}, {3.611409959503866*^9, 3.6114102272817717`*^9}, {
   3.611410390466289*^9, 3.611410397125464*^9}, {3.611410451130931*^9, 
   3.611410476911117*^9}, {3.61141052564783*^9, 3.611410527870366*^9}, {
   3.611410635452188*^9, 3.6114107062348843`*^9}, {3.6114107713662367`*^9, 
   3.611410781930188*^9}, {3.611411016022208*^9, 3.611411021314231*^9}, {
   3.611411302168413*^9, 3.611411302324971*^9}, {3.6114114808150053`*^9, 
   3.611411506252486*^9}, 3.611411810540511*^9, {3.6114763673266153`*^9, 
   3.6114763695419397`*^9}, {3.611477127340599*^9, 3.611477164083444*^9}, {
   3.611491947663316*^9, 3.6114920064057417`*^9}, 3.6114920419382544`*^9, {
   3.6114921573099623`*^9, 3.611492167048183*^9}, {3.611552532856927*^9, 
   3.611552572467552*^9}, 3.611554971580133*^9, {3.611555440515485*^9, 
   3.611555468055043*^9}, {3.611555536573697*^9, 3.611555561668569*^9}, {
   3.611556534868133*^9, 3.611556556296767*^9}, {3.611561424629118*^9, 
   3.611561429804811*^9}, {3.611563251221691*^9, 3.6115632780496902`*^9}, 
   3.6120214584066553`*^9, {3.6174509755968723`*^9, 3.617451021615361*^9}, {
   3.617451093586771*^9, 3.617451095893491*^9}, {3.617451265897502*^9, 
   3.617451412755507*^9}, 3.6174514895197697`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
(* 
Lithium atom:  
self-consistent calculation
*)\
\>", "Title",
 CellChangeTimes->{{3.612013688866342*^9, 3.6120136933644953`*^9}, {
  3.617451191946177*^9, 3.617451209843059*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Z", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"charge", " ", "of", " ", "nucleus"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "Z"}], "/", "r"}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"external", " ", "potential"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"soccupy", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "how", " ", "many", " ", "electrons", " ", "to", " ", "put", " ", "in", 
     " ", "each", " ", "s", " ", 
     RowBox[{"orbital", ".", "  ", 
      RowBox[{"soccupy", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "is", " ", "1", "s"}], ",", " ", 
    RowBox[{
     RowBox[{"soccupy", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "2", "s"}], ",", " ", 
    RowBox[{"etc", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"poccupy", "=", 
    RowBox[{"{", "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "many", " ", "electrons", " ", "go", " ", "in", " ", "each", 
     " ", "p", " ", 
     RowBox[{"orbital", ".", "  ", "everything"}], " ", "is", " ", 
     "spherically", " ", 
     RowBox[{"averaged", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"howmany", "=", "5"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "eigenfunctions", " ", "to", " ", "keep"}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"grid", " ", "properties"}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"INITIALNgrid", "=", "80"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"since", " ", "we", " ", "run", " ", "a", " ", "self"}], "-", 
     RowBox[{"consistent", " ", "loop"}]}], ",", " ", 
    RowBox[{"start", " ", "with", " ", "lower", " ", "accuracy"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FINALNgrid", "=", "420"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"and", " ", "work", " ", "your", " ", "way", " ", "up"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MAXr", "=", "42"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"largest", " ", "distance", " ", "out"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FOURTHorder", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "tolerance", " ", "to", " ", "get", " ", "FUNCTIONS", " ", "to", " ", 
     "in", " ", "BuildSpline"}], ",", " ", 
    RowBox[{"like", " ", 
     SubsuperscriptBox["v", "Hxc", "RNL"], 
     RowBox[{"(", "r", ")"}], " ", "and", " ", 
     SubscriptBox["R", "NL"], 
     RowBox[{"(", "r", ")"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"INITIALfunctionTOLERANCE", "=", "10*^-4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"start", " ", "small"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FINALfunctionTOLERANCE", "=", "10*^-6"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "work", " ", "to", " ", "greater", " ", "accuracy", " ", "later", " ", 
    "on"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Debug", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DEBUG", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SUPERdebug", "=", "False"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"KS", " ", "convergence", " ", "properties"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSenergytolerance", "=", "10*^-5"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "can", " ", "stop", " ", "grid", " ", "refinement", " ", "if", " ", 
      "energy", " ", "stops", " ", "changing", " ", "past", " ", "this", " ", 
      "decimal"}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"KSdensitytolerance", "=", "10*^-7"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "to", " ", "determine", " ", "convergence", " ", "in", " ", 
     "the", " ", "density"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"KSlambda", "=", "0.8"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "how", " ", "big", " ", "a", " ", "step", " ", "to", " ", "take", " ", 
      "each", " ", 
      RowBox[{"iteration", ".", "  ", "should"}], " ", "be", " ", "greater", 
      " ", "than", " ", "0"}], ",", " ", 
     RowBox[{"and", " ", "\[LessEqual]", " ", "1"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"KSitermax", "=", "30"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "max", " ", "iterations", " ", "of", " ", "the", " ", "KS", " ", 
     "scheme"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Every", " ", "self"}], "-", 
     RowBox[{
     "consistent", " ", "calculation", " ", "needs", " ", "a", " ", 
      "starting", " ", "density", " ", "guess"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Z", "^", "3"}], "/", "Pi"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "Z", " ", "r"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Z", "/", "2"}], ")"}], "^", "3"}], "/", "Pi"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"Z", "/", "2"}], ")"}], " ", "r"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Z", "/", "3"}], ")"}], "^", "3"}], " ", "/", "Pi"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"Z", "/", "3"}], ")"}], "r"}], "]"}]}]}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "KSNLR", " ", "will", " ", "take", " ", "care", " ", "of", " ", 
    "initiating", " ", "the", " ", "grid", " ", "each", " ", "iteration"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", "KSNLR"}], "Input",
 CellChangeTimes->{{3.6119392744214087`*^9, 3.6119392775908337`*^9}, {
  3.6119393320398273`*^9, 3.611939433225238*^9}, {3.617451056783464*^9, 
  3.617451072507794*^9}, {3.617451186210815*^9, 3.617451190433012*^9}, {
  3.617451240838171*^9, 3.617451281137354*^9}, {3.617451421320294*^9, 
  3.617451573923213*^9}}],

Cell[BoxData[
 StyleBox["\<\"KS-NLR calculation for Z = \\!\\(3\\), s occupation = \
\\!\\({2, 1}\\)\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0, 0],
  FrontFaceColor->RGBColor[1, 0, 0],
  BackFaceColor->RGBColor[1, 0, 0],
  GraphicsColor->RGBColor[1, 0, 0],
  FontSize->Large,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{3.611939434525392*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], ":", 
  " ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939440331953*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], ":", 
  " ", "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \[NoBreak]\\!\\(rp\\)\
\[NoBreak] near \[NoBreak]\\!\\({rp}\\)\[NoBreak] = \
\[NoBreak]\\!\\({1.4765144846105112`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(5.192288030730374`\\)\[NoBreak] and \
\[NoBreak]\\!\\(0.00002633768550509469`\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\", ButtonNote -> \
\\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939440359399*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], ":", 
  " ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939440558069*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], ":", 
  " ", "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \[NoBreak]\\!\\(rp\\)\
\[NoBreak] near \[NoBreak]\\!\\({rp}\\)\[NoBreak] = \
\[NoBreak]\\!\\({1.4765144846105112`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(1.459175944995207`\\)\[NoBreak] and \
\[NoBreak]\\!\\(0.000013223171818573014`\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\", ButtonNote -> \
\\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939440596755*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], ":", 
  " ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.61193945007548*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: \
slwcon\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939450113183*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], ":", 
  " ", "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \[NoBreak]\\!\\(rp\\)\
\[NoBreak] near \[NoBreak]\\!\\({rp}\\)\[NoBreak] = \
\[NoBreak]\\!\\({1.4765144846105112`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(5.192306179504976`\\)\[NoBreak] and \
\[NoBreak]\\!\\(8.187975772731`*^-6\\)\[NoBreak] for the integral and error \
estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\
\", ButtonNote -> \\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939450147603*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: \
ncvb\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.611939450148861*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"KS-NLR converged in 11 iterations.\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.611941298827201*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"eigen = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.3292455793939624`"}], ",", 
     RowBox[{"-", "0.16165364918018454`"}], ",", 
     RowBox[{"-", "0.03534105835188642`"}], ",", 
     RowBox[{"-", "0.01434104967692771`"}], ",", "0.0005942875901657926`"}], 
    "}"}]}],
  SequenceForm[
  "eigen = ", {-2.3292455793939624`, -0.16165364918018454`, \
-0.03534105835188642, -0.01434104967692771, 0.0005942875901657926}],
  Editable->False]], "Print",
 CellChangeTimes->{3.611941298830181*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    Ts = \"\>", "\[InvisibleSpace]", "8.170111348338299`"}],
  SequenceForm["    Ts = ", 8.170111348338299],
  Editable->False]], "Print",
 CellChangeTimes->{3.6119412988331347`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"     V = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "18.037275645540088`"}]}],
  SequenceForm["     V = ", -18.037275645540088`],
  Editable->False]], "Print",
 CellChangeTimes->{3.611941299119892*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    WH = \"\>", "\[InvisibleSpace]", "4.335976926373123`"}],
  SequenceForm["    WH = ", 4.335976926373123],
  Editable->False]], "Print",
 CellChangeTimes->{3.6119413589417887`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"WxcNLR = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.6389733863133875`"}]}],
  SequenceForm["WxcNLR = ", -2.6389733863133875`],
  Editable->False]], "Print",
 CellChangeTimes->{3.6119416720668707`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" EvNLR = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "8.170160757142053`"}]}],
  SequenceForm[" EvNLR = ", -8.170160757142053],
  Editable->False]], "Print",
 CellChangeTimes->{3.611941672146152*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAnX5iBjFkiz5C+kVHEaihPcTTIExX
IGk/7hmtr0csXT//xr6DICB5P/KIU1ido3w/DpK2sArYgj8kNDOafqGPP53A
jR8FIIk/ka0ywYaamz8s72SO/2ePP5wT9f0fLKU/3Q6e/vzXkj/iiqddzu6t
PySmCTb6+5U/Y3rv7P7/sz9sPXVt9x+ZP7CapVWXpbk/s9TgpPRDnD/Q67Hx
VN6/P/prTNzxZ58/Ar8SrF5Qwz9EzZEl9teiP8sDGB87z8o/6JhHwfRppD+V
qJiVTeTOP4xk/Vzz+6U/ixz5zoOW0T/T+2iU8B+pP3kEsyAMJdY/dsceMO+x
qj/cYinWkYvYPxqT1MvtQ6w/xzMKQp8E2z9iKkAD62evP6HVw3bpE+A/eKwL
ufLXsj+iRDgMbITlP1tMYXmmTrc/RkGQCWq27T+YQ6Nu
     "]], LineBox[CompressedData["
1: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
G8gaj8IWreB/tOFtaQ==
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJwVlWk81OsfQO3J8s9yaUP4JSHtkrieJxJlKUuUtbgoKSmKULIkFdGd4hKu
ZKlmsmeLL0WEUDFmQkyDGFTTGIax3P4vzue8Oe+PmmeAnbeQgIBA3G/+73Ir
hyT1SyzUS1Tc/aoxCcLFuTKKcSwUseVGwx6pSUgNVzO+4jGBCm0CVisIT4DE
TJdX9NUJFPK05wTBZEFEQGT8vQcTiG5cmX3pDQs8PQe789sm0G2Fva97Y1iw
xSLjLE1/Ei06SrU8kmBBg/zafwxkptADXXuDe2rjsDuhpc5MZwrl6mutCRId
hzyxkGHbg1PoRG3Oo+TxMbg7R93mFz6FsrqPpwaVjIHjIOlt2tgUmj0Z69t+
cAxYz2Sm+fXfEcNrrtU+9BtIqMVoDu79iYQ+ilzzFxqFFqPkbdfMfqJdRR/s
v0+NwM3jmfrKdj+Rcf37URJ9BISSKs1dzv7ubXXnbYpHYH5p0rc34yca3nm9
85znCEz0HyvoFGKjR3q7HGXahqE9VVOrvp2N8rWWT0qWMeF22e4dHnQ2+vMe
LfNBDhMsuvYbLI2wkejtnnbDv5nQuML1kNEyG71tz/n1+SITXl1OOlO54xfa
LCcKbruYQHGYe1r08BdqOu4XbV71FRJl2rSzT3KQxJqjVSa9DKjSVy63Oc9B
0oN7DjS2MGDYPQAthHGQr70Uz72aAYYUeQenFA6KnQ6SHMxgwNgh1wjpDg5y
naDpi/gwwDR6qjPUcBqdMWl1KZ8fAh53VbCdIhdd9YhYttw9BISy5/IywUU/
ByK/3ds8BDYHyuIpO7iomEQaHlUagtz7xzPFrbnoXAkp/L3oENhty26ui+ai
G40bgtlFg0A5vXOdDpuL6tx8D1oIDYJnnwMIt88giy6hvbdqB0AinXEukD6D
/F9yVqQ9G4AS5/NKg6MzyCHfjNWcMgDCn+NCqwVnUbLf2OzliwPwhFa9K1B/
FhXW6ZSt1xqA0R7Vgi+PZ9GGmNQiy/R+8OuaTKoK5aGVn5zc6Ml9IJcUijTj
eIi/OOUiHNUH1UfEvpNIPCS0ym3Z5GIfSHZusLxQyEOqf1SHC9n3Afm9najm
CA9NLysdilDog++tlaGko3NI8ws91DDzMwQ2xXgGaM4juWltJrWWDirDB8Vm
ds2jyZuVV6yL6dAmtPJZOJ5HCf8Eln18QgcNnMCOPzGPBLYNl4jfpQO9+kHk
kzvzSKrYKH2DCx32F+Vl0n/Mo9WXasYYfBrIprd8Nq3kI+lJk9515jSoq7p9
rbWRj2ZIhvv3GNHgLM1K3fYDHxkU7HV320GDJoUPZ9xZfPSUeH68Yz0NQpPo
vBClBaS7woO5l90LjFiW4ovIBbTp1Z8JKpm9UHxByn7NoUW0Kt1xX+kyFdrT
5EMpjovITH9fhS2XCqON67JM/lpEshUsCz6LCuvWak34X19E18Km7QOoVIhp
MItuKF9Eyh2hT2kUKjjKXS/1U19CI5J870x3KsyXsuVr+UtoRd/agmvNPZAd
dpa13UkAp7O8PBVKu2F7/UpenJsAFmemlIY974Z6kQLRQS8B/CX3sMlYTjcM
JQyrJlwQwCf7ZX98InWDyr9uTuPxAljJwt9n+nI3pDUeacx+JYCp3OZNtkbd
cF96d6acuiCO0TOOxm2fICprwXZ6UhDncQxqzHkfQeDTEH51VRhf9mtM/nL7
A2wK8glx0BbF9Xihd0SvC4a5KY6StWJ4p2uiBzLugMMjfhH3A8Vx2mOKqL5G
O9gMJ+moqEjgt5dc+I+sW4H1xjOyhSKJVwbkHM+CFtgqS1U29ZDGUf+6kVz1
m0ECcU/1c/6HRzW6cOd4E5hPOc+qH5PBW4X1mxhZjUB7/Zeg8xZZ/KOzwjAi
5A2U32p0V+XK4nE99iVq2GvwEQ0e6uiQw/cXDs+ERDaA18Wwcqk0eSyi8tmK
X1AP23x1OqxO/YFX+shxVrcDdMptkQw2UMDSDOF9jgfroOZFVPoWYUXsd8C5
aHLmFYQJah9tH1DES4XvnFzza0Ci/6rF+bLV+LmwQsL9K9UwkqdGygpfg5cy
mqKXL1QBafNakapja3GMCUfw4+lKSErzaT6lug4b5Gtrt0ZXgDPJrUPq2zp8
qtRXwqzkJfAO5M5l1a3HG2utpY2+lANzxCTkdZwSLvNx8o/VKIfHf+5Y//6U
Mh7vsho44lcGlNhgWV9dFbxoHvHsxdtSiDvmZSnMVcHkHJ1A+rZS0OvPfhr3
fgO20mxKkX9YAqla6ZT3lqrYcHvwLvFVJXC9PiHVskoVL93L19WMLQbr9cdy
WzeqYcZomU+eaDHsP9/sIhuvhsWiAg/pPCiCLCXPje1cNWwclDtXrFYEG9/k
P7RxUcfa4jXZElcKIUn3tfbHOnWs8+nwqbDKF+DDEfnwTpvAudQPdQwOBTyL
f6nG3yNwj/WFyINmFPCPsl84nExgr4Eaa2sTCgTbl/VK/U3gA30aVQ6IAre4
wYlJDwksZJd4xtuAAi8M5vgpGQT+HLZfJ1GXAnMNy9S85wS+bloqtqhAgaSP
UgmNzQTeWkFrsPlGhrScc6dvviPwU8fcX6eHyZAT1GFq0UbgmHznmmgGGV4q
Js23dRB4NdEqX9NHhn5n+dOfeghcSOvr295FBk3mWtOvTAKjmcbsvVVk2F52
VeXJCIEDxTWNXF+SYV9s35z3NwIz7fPPRpaSwUozo2icRWAnvaPxrRQyXDyr
qsJmE9g71LPa+zEZwo1uzJVwCNxC7uElZJEhVvprdxCXwKOOQm0vH5EhtTDn
Do9H4DlKj5ZEChkeR4r4Vs8T2FqbeLmbRIbntt4m4QsEVnx1pccjmQxl6m+V
jZcIzGvNi7uTSIY6zqa534PB+XXR7RV3yPAfXhBzYA==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotLabel->FormBox[
   "\"4\\!\\(\\*SuperscriptBox[\\(\[Pi]r\\), \\(2\\)]\\) n(r) and \
\\!\\(\\*SubsuperscriptBox[\\(v\\), \\(xc\\), \\(NLR\\)]\\)(r)\"", 
    TraditionalForm],
  PlotRange->{{0, 10}, {-0.8796246288630937, 0.928517359427169}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Print",
 CellChangeTimes->{3.611941889037492*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"CONVERGED", " ", "LITHIUM", " ", "QUANTITIES"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "These", " ", "are", " ", "the", " ", "quantities", " ", "you", " ", 
     "should", " ", "get"}], ",", " ", 
    RowBox[{"roughly", " ", 
     RowBox[{"speaking", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15.341151514346231`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.00008284600389863547`", ",", "15.333539766979221`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.011654850761193911`", ",", "14.305334861665617`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"0.03471601427188583`", ",", "12.459688787666304`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.06926633653597439`", ",", "10.135184609220232`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.11530581755345956`", ",", "7.704575809898833`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.17283445732434138`", ",", "5.478796550789142`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.24185225584861988`", ",", "3.649738642762259`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.322359213126295`", ",", "2.2820777647886135`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.4143553291573667`", ",", "1.342696194863727`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.5178406039418352`", ",", "0.7455621835539568`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.6328150374797002`", ",", "0.392040576116269`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.7592786297709618`", ",", "0.1961751936722405`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.8972313808156201`", ",", "0.09436039726191667`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.046673290613675`", ",", "0.04469372136222273`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.2076043591651267`", ",", "0.021986687888758016`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1.3800245864699747`", ",", "0.012245112725296404`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1.5639339725282198`", ",", "0.008247250822996434`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1.7593325173398613`", ",", "0.006539973534652159`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"1.9662202209048996`", ",", "0.005614033056500674`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"2.184597083223334`", ",", "0.004888939060050156`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.414463104295166`", ",", "0.004189990070664949`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.6558182841203934`", ",", "0.0034981557870670623`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.9086626226990187`", ",", "0.00284000767290821`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"3.1729961200310397`", ",", "0.0022446456671783572`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.448818776116458`", ",", "0.0017304090530069103`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"3.736130590955272`", ",", "0.0013036135682809751`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"4.034931564547483`", ",", "0.0009613406958235644`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"4.345221696893091`", ",", "0.0006949436653020966`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"4.667000987992096`", ",", "0.0004930340551790499`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"5.000269437844498`", ",", "0.0003436228022677789`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"5.345027046450294`", ",", "0.00023545837917359413`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.70127381380949`", ",", "0.0001587312711883642`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6.06900973992208`", ",", "0.00010533346810249066`"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"6.448234824788068`", ",", "0.00006883735508102298`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.838949068407453`", ",", "0.00004432005228831857`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.241152470780234`", ",", "0.00002812100736126501`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.654845031906412`", ",", "0.00001758850168185602`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.080026751785985`", ",", "0.000010846449740789`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"8.516697630418957`", ",", "6.596058607038283`*^-6"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"8.964857667805324`", ",", "3.956248446401264`*^-6"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"9.424506863945089`", ",", "2.340656967910114`*^-6"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"9.895645218838249`", ",", "1.3661270014276656`*^-6"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.378272732484808`", ",", "7.86647050399331`*^-7"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"10.872389404884762`", ",", "4.469249505366658`*^-7"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.377995236038112`", ",", "2.505419030746749`*^-7"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.895090225944859`", ",", "1.3859205614985134`*^-7"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.423674374605003`", ",", "7.565300857987578`*^-8"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.963747682018544`", ",", "4.075293399608248`*^-8"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13.515310148185481`", ",", "2.1664515698804584`*^-8"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.078361773105815`", ",", "1.1365989161973487`*^-8"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.652902556779546`", ",", "5.884950257404521`*^-9"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.238932499206674`", ",", "3.0072083626407817`*^-9"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.836451600387198`", ",", "1.5166179345106553`*^-9"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"16.44545986032112`", ",", "7.548952077762064`*^-10"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.065957279008437`", ",", "3.708515272150983`*^-10"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.69794385644915`", ",", "1.7981290586784976`*^-10"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.34141959264326`", ",", "8.605040972537315`*^-11"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.996384487590763`", ",", "4.064431046314932`*^-11"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"19.66283854129167`", ",", "1.8948042234012023`*^-11"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.34078175374597`", ",", "8.718652603340865`*^-12"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.030214124953666`", ",", "3.959653831133156`*^-12"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.73113565491476`", ",", "1.7749657827057404`*^-12"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"22.44354634362925`", ",", "7.853252020220177`*^-13"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.167446191097138`", ",", "3.4295530409029827`*^-13"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.90283519731842`", ",", "1.4782756490094943`*^-13"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"24.649713362293102`", ",", "6.28933224580614`*^-14"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.40808068602118`", ",", "2.6411071761657928`*^-14"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.177937168502652`", ",", "1.094714600674535`*^-14"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.959282809737523`", ",", "4.47868056923988`*^-15"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"27.75211760972579`", ",", "1.8085659641470276`*^-15"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"28.556441568467452`", ",", "7.208656611439906`*^-16"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"29.372254685962513`", ",", "2.836028031311695`*^-16"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.19955696221097`", ",", "1.1012934074211296`*^-16"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.038348397212825`", ",", "4.2211560644783956`*^-17"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.88862899096807`", ",", "1.5969584185842237`*^-17"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"32.75039874347672`", ",", "5.963254393496871`*^-18"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"33.623657654738764`", ",", "2.1977765264180707`*^-18"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"34.508405724754205`", ",", "7.99371696652012`*^-19"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"35.404642953523044`", ",", "2.8685058880241404`*^-19"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"36.312369341045276`", ",", "1.0178794908791353`*^-19"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"37.231584887320906`", ",", 
          RowBox[{"-", "7.765527712627521`*^-23"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"38.16228959234993`", ",", 
          RowBox[{"-", "3.33077479606927`*^-25"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"39.10448345613235`", ",", 
          RowBox[{"-", "1.3387880815882558`*^-27"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.05816647866817`", ",", 
          RowBox[{"-", "4.7813543624156736`*^-30"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"41.02333865995738`", ",", 
          RowBox[{"-", "1.2806852283430335`*^-32"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"42.`", ",", "6.235419283480209`*^-45"}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vxcNLR", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "3.480920638340791`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.00008284600389863547`", ",", 
          RowBox[{"-", "3.4809183527901433`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.011654850761193911`", ",", 
          RowBox[{"-", "3.4768501876341515`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.03471601427188583`", ",", 
          RowBox[{"-", "3.447280259530708`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.06926633653597439`", ",", 
          RowBox[{"-", "3.3602342599271022`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.11530581755345956`", ",", 
          RowBox[{"-", "3.1888977378636714`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.17283445732434138`", ",", 
          RowBox[{"-", "2.9249454044136334`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.24185225584861988`", ",", 
          RowBox[{"-", "2.5841502719964584`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.322359213126295`", ",", 
          RowBox[{"-", "2.2019727637676185`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4143553291573667`", ",", 
          RowBox[{"-", "1.8219772315274807`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5178406039418352`", ",", 
          RowBox[{"-", "1.481589702112368`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6328150374797002`", ",", 
          RowBox[{"-", "1.1987056009698427`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.7592786297709618`", ",", 
          RowBox[{"-", "0.972901065342971`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.8972313808156201`", ",", 
          RowBox[{"-", "0.7969742141524302`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.046673290613675`", ",", 
          RowBox[{"-", "0.6620526537481441`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.2076043591651267`", ",", 
          RowBox[{"-", "0.559387282826464`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.3800245864699747`", ",", 
          RowBox[{"-", "0.4811754232023321`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.5639339725282198`", ",", 
          RowBox[{"-", "0.42093750477660336`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.7593325173398613`", ",", 
          RowBox[{"-", "0.3735970424288834`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.9662202209048996`", ",", 
          RowBox[{"-", "0.33536956790831424`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.184597083223334`", ",", 
          RowBox[{"-", "0.3035535195298917`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.414463104295166`", ",", 
          RowBox[{"-", "0.2762933702844289`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.6558182841203934`", ",", 
          RowBox[{"-", "0.2523599447147824`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.9086626226990187`", ",", 
          RowBox[{"-", "0.23096432391182334`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.1729961200310397`", ",", 
          RowBox[{"-", "0.21161381158115333`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.448818776116458`", ",", 
          RowBox[{"-", "0.19400494860680936`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.736130590955272`", ",", 
          RowBox[{"-", "0.17794776279189875`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.034931564547483`", ",", 
          RowBox[{"-", "0.1633151179568817`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.345221696893091`", ",", 
          RowBox[{"-", "0.1500103658303939`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.667000987992096`", ",", 
          RowBox[{"-", "0.13794843981711463`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.000269437844498`", ",", 
          RowBox[{"-", "0.1270460740408667`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.345027046450294`", ",", 
          RowBox[{"-", "0.11721791857640294`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.70127381380949`", ",", 
          RowBox[{"-", "0.10837614740539743`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.06900973992208`", ",", 
          RowBox[{"-", "0.10043186679401199`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.448234824788068`", ",", 
          RowBox[{"-", "0.09329720394217843`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.838949068407453`", ",", 
          RowBox[{"-", "0.08688739521723192`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.241152470780234`", ",", 
          RowBox[{"-", "0.08112251195555396`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.654845031906412`", ",", 
          RowBox[{"-", "0.07592867843699322`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.080026751785985`", ",", 
          RowBox[{"-", "0.07123877367657307`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.516697630418957`", ",", 
          RowBox[{"-", "0.06699266947254791`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.964857667805324`", ",", 
          RowBox[{"-", "0.06313713883958996`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.424506863945089`", ",", 
          RowBox[{"-", "0.0596254767430615`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.895645218838249`", ",", 
          RowBox[{"-", "0.05641698706584943`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.378272732484808`", ",", 
          RowBox[{"-", "0.053476378504647606`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.872389404884762`", ",", 
          RowBox[{"-", "0.05077313420156129`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.377995236038112`", ",", 
          RowBox[{"-", "0.04828089998304523`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.895090225944859`", ",", 
          RowBox[{"-", "0.04597691213429163`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.423674374605003`", ",", 
          RowBox[{"-", "0.043841480933596765`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.963747682018544`", ",", 
          RowBox[{"-", "0.04185753505732667`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13.515310148185481`", ",", 
          RowBox[{"-", "0.040010226910757146`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.078361773105815`", ",", 
          RowBox[{"-", "0.03828659533432065`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.652902556779546`", ",", 
          RowBox[{"-", "0.036675280196560835`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.238932499206674`", ",", 
          RowBox[{"-", "0.03516628256823866`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.836451600387198`", ",", 
          RowBox[{"-", "0.033750764092215946`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"16.44545986032112`", ",", 
          RowBox[{"-", "0.03242087952736462`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.065957279008437`", ",", 
          RowBox[{"-", "0.0311696370432495`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.69794385644915`", ",", 
          RowBox[{"-", "0.029990781543039594`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.34141959264326`", ",", 
          RowBox[{"-", "0.028878696940063474`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.996384487590763`", ",", 
          RowBox[{"-", "0.027828324149313886`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"19.66283854129167`", ",", 
          RowBox[{"-", "0.026835091777813465`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.34078175374597`", ",", 
          RowBox[{"-", "0.02589485744773393`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.030214124953666`", ",", 
          RowBox[{"-", "0.02500385777240117`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.73113565491476`", ",", 
          RowBox[{"-", "0.024158665490401257`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"22.44354634362925`", ",", 
          RowBox[{"-", "0.023356152558515073`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.167446191097138`", ",", 
          RowBox[{"-", "0.022593458195718733`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.90283519731842`", ",", 
          RowBox[{"-", "0.021867961081630936`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"24.649713362293102`", ",", 
          RowBox[{"-", "0.02117725505597033`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.40808068602118`", ",", 
          RowBox[{"-", "0.020519127786263577`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.177937168502652`", ",", 
          RowBox[{"-", "0.01989154196671521`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.959282809737523`", ",", 
          RowBox[{"-", "0.019292618687676056`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"27.75211760972579`", ",", 
          RowBox[{"-", "0.018720622676399044`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"28.556441568467452`", ",", 
          RowBox[{"-", "0.018173949159114945`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"29.372254685962513`", ",", 
          RowBox[{"-", "0.017651112134287186`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.19955696221097`", ",", 
          RowBox[{"-", "0.017150733879295478`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.038348397212825`", ",", 
          RowBox[{"-", "0.01667153553930316`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.88862899096807`", ",", 
          RowBox[{"-", "0.016212328668875828`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"32.75039874347672`", ",", 
          RowBox[{"-", "0.015772007615009465`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"33.623657654738764`", ",", 
          RowBox[{"-", "0.015349542645329891`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"34.508405724754205`", ",", 
          RowBox[{"-", "0.014943973737928733`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"35.404642953523044`", ",", 
          RowBox[{"-", "0.0145544049600281`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"36.312369341045276`", ",", 
          RowBox[{"-", "0.014179999371806072`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"37.231584887320906`", ",", 
          RowBox[{"-", "0.013819974399531748`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"38.16228959234993`", ",", 
          RowBox[{"-", "0.013473597628869235`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"39.10448345613235`", ",", 
          RowBox[{"-", "0.013140182975009268`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.05816647866817`", ",", 
          RowBox[{"-", "0.012819087191317566`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"41.02333865995738`", ",", 
          RowBox[{"-", "0.01250970668255046`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"42.`", ",", 
          RowBox[{"-", "0.01221147459250648`"}]}], "}"}]}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vH", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "6.01242521518003`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.00008284600389863547`", ",", "6.012424994708792`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.011654850761193911`", ",", "6.008210145430318`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.03471601427188583`", ",", "5.977491295535462`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.06926633653597439`", ",", "5.8866153367542084`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.11530581755345956`", ",", "5.706284243178384`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.17283445732434138`", ",", "5.424422092941848`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.24185225584861988`", ",", "5.0507593973668685`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.322359213126295`", ",", "4.6125873369707735`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.4143553291573667`", ",", "4.145288814914215`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.5178406039418352`", ",", "3.6825842209556563`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.6328150374797002`", ",", "3.2500239076400925`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.7592786297709618`", ",", "2.8627296378629934`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.8972313808156201`", ",", "2.526410120440448`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.046673290613675`", ",", "2.2399812351110318`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.2076043591651267`", ",", "1.9984064639630832`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.3800245864699747`", ",", "1.7949932697554098`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.5639339725282198`", ",", "1.62291648930773`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.7593325173398613`", ",", "1.4760466311565659`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.9662202209048996`", ",", "1.3492807248674494`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.184597083223334`", ",", "1.238573419854507`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.414463104295166`", ",", "1.1408183193796098`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.6558182841203934`", ",", "1.0536750481764896`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"2.9086626226990187`", ",", "0.97539434315904`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"3.1729961200310397`", ",", "0.9046651212273473`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"3.448818776116458`", ",", "0.8404912949535287`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"3.736130590955272`", ",", "0.7820979604832852`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"4.034931564547483`", ",", "0.728863077520002`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"4.345221696893091`", ",", "0.6802696836108987`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"4.667000987992096`", ",", "0.6358737750099306`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"5.000269437844498`", ",", "0.5952835861679139`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"5.345027046450294`", ",", "0.558146777834361`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"5.70127381380949`", ",", "0.5241428324898316`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6.06900973992208`", ",", "0.49297867071315815`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6.448234824788068`", ",", "0.46438610364160193`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6.838949068407453`", ",", "0.43812021281930563`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"7.241152470780234`", ",", "0.41395810457463184`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"7.654845031906412`", ",", "0.39169773679040876`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"8.080026751785985`", ",", "0.37115668131557683`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"8.516697630418957`", ",", "0.352170785780082`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"8.964857667805324`", ",", "0.3345927528550139`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"9.424506863945089`", ",", "0.318290678547294`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"9.895645218838249`", ",", "0.303146595892425`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"10.378272732484808`", ",", "0.2890550650157018`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"10.872389404884762`", ",", "0.27592184073170606`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"11.377995236038112`", ",", "0.2636626381821544`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"11.895090225944859`", ",", "0.2522020074022112`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"12.423674374605003`", ",", "0.24147232000247185`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"12.963747682018544`", ",", "0.23141286553843854`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"13.515310148185481`", ",", "0.22196905142669915`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"14.078361773105815`", ",", "0.21309169811027007`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"14.652902556779546`", ",", "0.20473642019056407`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"15.238932499206674`", ",", "0.1968630840774941`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"15.836451600387198`", ",", "0.1894353330714062`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"16.44545986032112`", ",", "0.18242017145899023`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"17.065957279008437`", ",", "0.17578760002174604`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"17.69794385644915`", ",", "0.1695102962141378`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"18.34141959264326`", ",", "0.16356333310360316`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"18.996384487590763`", ",", "0.1579239319392286`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"19.66283854129167`", ",", "0.1525712439128336`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"20.34078175374597`", ",", "0.14748615729050865`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"21.030214124953666`", ",", "0.14265112662675747`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"21.73113565491476`", ",", "0.1380500212336304`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"22.44354634362925`", ",", "0.1336679904716113`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"23.167446191097138`", ",", "0.12949134376591478`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"23.90283519731842`", ",", "0.12550744353924434`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"24.649713362293102`", ",", "0.12170460949719877`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"25.40808068602118`", ",", "0.11807203291177074`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"26.177937168502652`", ",", "0.11459969972723279`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"26.959282809737523`", ",", "0.11127832146584021`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"27.75211760972579`", ",", "0.10809927304213512`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"28.556441568467452`", ",", "0.10505453670754743`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"29.372254685962513`", ",", "0.10213665144424082`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"30.19955696221097`", ",", "0.09933866721109799`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"31.038348397212825`", ",", "0.09665410351734713`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"31.88862899096807`", ",", "0.09407691186226282`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"32.75039874347672`", ",", "0.09160144163402734`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"33.623657654738764`", ",", "0.08922240910839462`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"34.508405724754205`", ",", "0.08693486922925864`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"35.404642953523044`", ",", "0.08473418988944174`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"36.312369341045276`", ",", "0.08261602846170409`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"37.231584887320906`", ",", "0.08057631035775063`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"38.16228959234993`", ",", "0.0786112094174006`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"39.10448345613235`", ",", "0.07671712995153374`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"40.05816647866817`", ",", "0.07489069028132533`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"41.02333865995738`", ",", "0.07312870763295459`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"42.`", ",", "0.0714281842617073`"}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vxcNLRdirect", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "2.1260612366150684`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.00008284600389863547`", ",", 
          RowBox[{"-", "2.126061133146376`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.011654850761193911`", ",", 
          RowBox[{"-", "2.1240875863463193`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.03471601427188583`", ",", 
          RowBox[{"-", "2.1097793541457053`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.06926633653597439`", ",", 
          RowBox[{"-", "2.067836792148846`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.11530581755345956`", ",", 
          RowBox[{"-", "1.9857241551743914`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.17283445732434138`", ",", 
          RowBox[{"-", "1.8596902000585118`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.24185225584861988`", ",", 
          RowBox[{"-", "1.6963446408235698`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.322359213126295`", ",", 
          RowBox[{"-", "1.509740425877544`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4143553291573667`", ",", 
          RowBox[{"-", "1.3162561693266206`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5178406039418352`", ",", 
          RowBox[{"-", "1.130104573075681`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6328150374797002`", ",", 
          RowBox[{"-", "0.9610225994997117`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.7592786297709618`", ",", 
          RowBox[{"-", "0.8140314307401016`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.8972313808156201`", ",", 
          RowBox[{"-", "0.6903511055953901`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.046673290613675`", ",", 
          RowBox[{"-", "0.5886543369563462`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.2076043591651267`", ",", 
          RowBox[{"-", "0.5062179800973855`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.3800245864699747`", ",", 
          RowBox[{"-", "0.4398003028616473`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.5639339725282198`", ",", 
          RowBox[{"-", "0.38621542144655757`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.7593325173398613`", ",", 
          RowBox[{"-", "0.3426460387428879`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.9662202209048996`", ",", 
          RowBox[{"-", "0.3067665231156797`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.184597083223334`", ",", 
          RowBox[{"-", "0.27674843927908777`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.414463104295166`", ",", 
          RowBox[{"-", "0.25120526311681834`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.6558182841203934`", ",", 
          RowBox[{"-", "0.22911383946434644`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.9086626226990187`", ",", 
          RowBox[{"-", "0.20973399986210992`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.1729961200310397`", ",", 
          RowBox[{"-", "0.19253678951205344`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.448818776116458`", ",", 
          RowBox[{"-", "0.17714525659101235`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.736130590955272`", ",", 
          RowBox[{"-", "0.1632882564034784`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.034931564547483`", ",", 
          RowBox[{"-", "0.15076604057101947`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.345221696893091`", ",", 
          RowBox[{"-", "0.1394257199724174`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.667000987992096`", ",", 
          RowBox[{"-", "0.12914453832709025`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.000269437844498`", ",", 
          RowBox[{"-", "0.11981901876350987`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.345027046450294`", ",", 
          RowBox[{"-", "0.11135830936905587`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.70127381380949`", ",", 
          RowBox[{"-", "0.10368037214398221`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.06900973992208`", ",", 
          RowBox[{"-", "0.09670997980746746`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.448234824788068`", ",", 
          RowBox[{"-", "0.09037777371703411`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.838949068407453`", ",", 
          RowBox[{"-", "0.08461987661913722`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.241152470780234`", ",", 
          RowBox[{"-", "0.07937774076470491`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.654845031906412`", ",", 
          RowBox[{"-", "0.07459804789528918`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.080026751785985`", ",", 
          RowBox[{"-", "0.0702325701299915`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.516697630418957`", ",", 
          RowBox[{"-", "0.06623795908112917`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.964857667805324`", ",", 
          RowBox[{"-", "0.06257546373677005`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.424506863945089`", ",", 
          RowBox[{"-", "0.05921059373654193`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.895645218838249`", ",", 
          RowBox[{"-", "0.056112749965512375`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.378272732484808`", ",", 
          RowBox[{"-", "0.05325484355789463`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.872389404884762`", ",", 
          RowBox[{"-", "0.05061292062037186`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.377995236038112`", ",", 
          RowBox[{"-", "0.048165805258433905`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.895090225944859`", ",", 
          RowBox[{"-", "0.045894768955653815`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.423674374605003`", ",", 
          RowBox[{"-", "0.043783230560910665`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12.963747682018544`", ",", 
          RowBox[{"-", "0.041816488256243414`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13.515310148185481`", ",", 
          RowBox[{"-", "0.03998148287186991`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.078361773105815`", ",", 
          RowBox[{"-", "0.038266590648280155`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14.652902556779546`", ",", 
          RowBox[{"-", "0.03666144284959787`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.238932499206674`", ",", 
          RowBox[{"-", "0.03515676934577976`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.836451600387198`", ",", 
          RowBox[{"-", "0.033744263266964475`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"16.44545986032112`", ",", 
          RowBox[{"-", "0.03241646398511033`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.065957279008437`", ",", 
          RowBox[{"-", "0.0311666559192285`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17.69794385644915`", ",", 
          RowBox[{"-", "0.02998878093868766`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.34141959264326`", ",", 
          RowBox[{"-", "0.028877362421239786`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18.996384487590763`", ",", 
          RowBox[{"-", "0.02782743928927063`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"19.66283854129167`", ",", 
          RowBox[{"-", "0.026834508589613646`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.34078175374597`", ",", 
          RowBox[{"-", "0.02589447539531224`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.030214124953666`", ",", 
          RowBox[{"-", "0.025003608991965062`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21.73113565491476`", ",", 
          RowBox[{"-", "0.024158504468686667`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"22.44354634362925`", ",", 
          RowBox[{"-", "0.023356048967087668`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.167446191097138`", ",", 
          RowBox[{"-", "0.022593391954196372`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23.90283519731842`", ",", 
          RowBox[{"-", "0.021867918979921002`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"24.649713362293102`", ",", 
          RowBox[{"-", "0.021177228459263918`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.40808068602118`", ",", 
          RowBox[{"-", "0.020519111086496466`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.177937168502652`", ",", 
          RowBox[{"-", "0.019891531544905083`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"26.959282809737523`", ",", 
          RowBox[{"-", "0.019292612223370184`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"27.75211760972579`", ",", 
          RowBox[{"-", "0.0187206186912689`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"28.556441568467452`", ",", 
          RowBox[{"-", "0.018173946717366284`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"29.372254685962513`", ",", 
          RowBox[{"-", "0.017651110647347645`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.19955696221097`", ",", 
          RowBox[{"-", "0.017150732979351`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.038348397212825`", ",", 
          RowBox[{"-", "0.016671534997970236`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"31.88862899096807`", ",", 
          RowBox[{"-", "0.01621232834525545`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"32.75039874347672`", ",", 
          RowBox[{"-", "0.015772007422732857`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"33.623657654738764`", ",", 
          RowBox[{"-", "0.015349542531794108`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"34.508405724754205`", ",", 
          RowBox[{"-", "0.014943973671301543`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"35.404642953523044`", ",", 
          RowBox[{"-", "0.014554404921170187`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"36.312369341045276`", ",", 
          RowBox[{"-", "0.014179999349283734`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"37.231584887320906`", ",", 
          RowBox[{"-", "0.013819974386558449`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"38.16228959234993`", ",", 
          RowBox[{"-", "0.013473597621442679`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"39.10448345613235`", ",", 
          RowBox[{"-", "0.013140182970784313`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.05816647866817`", ",", 
          RowBox[{"-", "0.012819087188928916`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"41.02333865995738`", ",", 
          RowBox[{"-", "0.0125097066812084`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"42.`", ",", 
          RowBox[{"-", "0.012211474591757135`"}]}], "}"}]}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"END", " ", "LITHIUM", " ", "QUANTITIES"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.611972356796145*^9, 3.6119723895489264`*^9}, {
   3.611972422642942*^9, 3.611972481319146*^9}, {3.612407060637196*^9, 
   3.612407064604624*^9}, {3.617451157773909*^9, 3.617451168769184*^9}, 
   3.617451896603405*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 147, 2, 93, "Title"],
Cell[729, 26, 125452, 2970, 13621, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126218, 3001, 413, 9, 264, "Title"],
Cell[126634, 3012, 8767, 193, 737, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135438, 3210, 192, 7, 264, "Title"],
Cell[CellGroupData[{
Cell[135655, 3221, 6800, 182, 693, "Input"],
Cell[142458, 3405, 374, 10, 37, "Print"],
Cell[142835, 3417, 565, 10, 23, "Message"],
Cell[143403, 3429, 789, 14, 23, "Message"],
Cell[144195, 3445, 565, 10, 23, "Message"],
Cell[144763, 3457, 790, 14, 23, "Message"],
Cell[145556, 3473, 564, 10, 23, "Message"],
Cell[146123, 3485, 522, 10, 23, "Message"],
Cell[146648, 3497, 783, 13, 23, "Message"],
Cell[147434, 3512, 520, 10, 23, "Message"],
Cell[CellGroupData[{
Cell[147979, 3526, 318, 8, 23, "Print"],
Cell[148300, 3536, 574, 14, 23, "Print"],
Cell[148877, 3552, 231, 5, 23, "Print"],
Cell[149111, 3559, 252, 6, 23, "Print"],
Cell[149366, 3567, 231, 5, 23, "Print"],
Cell[149600, 3574, 254, 6, 23, "Print"],
Cell[149857, 3582, 249, 6, 23, "Print"],
Cell[150109, 3590, 12013, 207, 238, "Print"]
}, Open  ]]
}, Open  ]],
Cell[162149, 3801, 44383, 1084, 2057, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
